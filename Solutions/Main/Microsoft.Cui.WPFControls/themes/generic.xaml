<ResourceDictionary 
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"    
  xmlns:local="clr-namespace:Microsoft.Cui.Controls"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Microsoft.Cui.WPFControls;component/DateInputBoxControl/DateInputBoxStyles.xaml" />
        <ResourceDictionary Source="/Microsoft.Cui.WPFControls;component/SearchAndPrescribeControl/SearchAndPrescribeStyles.xaml" />
        <ResourceDictionary Source="/Microsoft.Cui.WPFControls;component/GraphingControl/TimeActivityGraphStyles.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <!-- Control Template / Styles -->
    <ControlTemplate TargetType="ToolTip" x:Key="ToolTipTemplate">
        <Border BorderBrush="#FF080808" BorderThickness="1,1,1,1" Background="#FFFFFBE9" CornerRadius="2">
            <Grid>
                <ContentPresenter Grid.Column="0"
                                        Content="{TemplateBinding Content}"
                                        ContentTemplate="{TemplateBinding ContentTemplate}"
                                        Margin="{TemplateBinding Padding}" 
                                        VerticalAlignment="Top"
                                        HorizontalAlignment="Left"/>

            </Grid>
        </Border>
    </ControlTemplate>

    <!-- BEGIN MatchingTermItemsControl Styles -->
    <Style TargetType="local:MatchingTermItemsControl">
        <Setter Property="ItemContainerStyle">
            <Setter.Value>
                <Style TargetType="local:MatchingTermItemContainer">
                    <Setter Property="Background" Value="#FF448DCA"/>
                    <Setter Property="Foreground" Value="#FF000000"/>
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="VerticalContentAlignment" Value="Top"/>
                    <Setter Property="Padding" Value="1,1,0,0"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="BorderBrush">
                        <Setter.Value>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                <GradientStop Color="#FF718597" Offset="0.375"/>
                                <GradientStop Color="#FF617584" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="local:MatchingTermItemContainer">
                                <Grid Margin="0,0,1,0">
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="CommonStates">
                                            <VisualState x:Name="Normal">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="MouseOverGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="Disabled" />
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="FocusStates">
                                            <VisualState x:Name="Focused" />
                                            <VisualState x:Name="Unfocused" />
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="ControlFocusStates">
                                            <VisualState x:Name="NoFocus" />
                                            <VisualState x:Name="CheckBoxFocused">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="CheckBoxFocusRectangle" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="EncodableInputBoxFocused" />
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="HighlightStates">
                                            <VisualState x:Name="Unhighlighted">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="HighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="Highlighted">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="HighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Grid x:Name="MouseOverGrid" Opacity="0" Grid.Column="1">
                                        <Border Background="#ffebc822" CornerRadius="0"
                                        Margin="{TemplateBinding Padding}"
                                        BorderThickness="1">
                                            <Border.BorderBrush>
                                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                                    <GradientStop Color="#FF718597" Offset="0.375"/>
                                                    <GradientStop Color="#FF617584" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.BorderBrush>
                                            <Border CornerRadius="0">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                        <GradientStop Offset="0" Color="#ffffffff" />
                                                        <GradientStop Offset="0.05" Color="#99ffffff" />
                                                        <GradientStop Offset="0.95" Color="#44ffffff" />
                                                        <GradientStop Offset="1" Color="#00ffffff" />
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                        </Border>
                                    </Grid>

                                    <Rectangle Margin="0,3,0,3" Stroke="#7f000000" StrokeDashArray="2 2" StrokeThickness="1" x:Name="CheckBoxFocusRectangle" Opacity="0"
                                               />

                                    <Grid x:Name="HighlightGrid" Opacity="0" Grid.Column="1">
                                        <Border Background="#ffebc822" CornerRadius="0"
                                        Margin="{TemplateBinding Padding}"
                                        BorderThickness="1">
                                            <Border.BorderBrush>
                                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                                    <GradientStop Color="#FF718597" Offset="0.375"/>
                                                    <GradientStop Color="#FF617584" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.BorderBrush>
                                            <Border CornerRadius="0">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                        <GradientStop Offset="0" Color="#ffffffff" />
                                                        <GradientStop Offset="0.05" Color="#99ffffff" />
                                                        <GradientStop Offset="0.95" Color="#44ffffff" />
                                                        <GradientStop Offset="1" Color="#00ffffff" />
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                        </Border>
                                    </Grid>

                                    <CheckBox x:Name="CheckBox" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="3,6,3,0" Padding="0" />

                                    <local:EncodableInputBox x:Name="EncodableInputBox" 
                                                 Grid.Column="1" 
                                                 HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}"                                                                                   
                                                 IsReadOnly="True"
                                                 DropdownMaxHeight="200"
                                                 ItemTemplate="{TemplateBinding ContentTemplate}"
                                                 EncodedItemTemplate="{TemplateBinding EncodedItemTemplate}"
                                                 FlyOutContentTemplate="{TemplateBinding FlyOutContentTemplate}"
                                                 >
                                    </local:EncodableInputBox>

                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:MatchingTermItemsControl">
                    <ScrollViewer x:Name="ScrollViewer" 
                                  Padding="4,0,4,0"
                                  HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto"
                                  BorderThickness="0" IsTabStop="False">
                        <ItemsPresenter />
                    </ScrollViewer>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:MatchingTermItemContainer">
        <Setter Property="Background" Value="#FF448DCA"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="VerticalContentAlignment" Value="Top"/>
        <Setter Property="Padding" Value="1,1,0,0"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                    <GradientStop Color="#FF718597" Offset="0.375"/>
                    <GradientStop Color="#FF617584" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:MatchingTermItemContainer">
                    <Grid Margin="0,0,1,0">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="MouseOverGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Disabled" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused" />
                                <VisualState x:Name="Unfocused" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ControlFocusStates">
                                <VisualState x:Name="NoFocus" />
                                <VisualState x:Name="CheckBoxFocused">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="CheckBoxFocusRectangle" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="EncodableInputBoxFocused" />
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="HighlightStates">
                                <VisualState x:Name="Unhighlighted">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="HighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Highlighted">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="HighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Grid x:Name="MouseOverGrid" Opacity="0" Grid.Column="1">
                            <Border Background="#ffebc822" CornerRadius="0"
                                        Margin="{TemplateBinding Padding}"
                                        BorderThickness="1">
                                <Border.BorderBrush>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                        <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                        <GradientStop Color="#FF718597" Offset="0.375"/>
                                        <GradientStop Color="#FF617584" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.BorderBrush>
                                <Border CornerRadius="0">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                            <GradientStop Offset="0" Color="#ffffffff" />
                                            <GradientStop Offset="0.05" Color="#99ffffff" />
                                            <GradientStop Offset="0.95" Color="#44ffffff" />
                                            <GradientStop Offset="1" Color="#00ffffff" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                            </Border>
                        </Grid>

                        <Rectangle Margin="0,3,0,3" Stroke="#7f000000" StrokeDashArray="2 2" StrokeThickness="1" x:Name="CheckBoxFocusRectangle" Opacity="0"
                                               />

                        <Grid x:Name="HighlightGrid" Opacity="0" Grid.Column="1">
                            <Border Background="#ffebc822" CornerRadius="0"
                                        Margin="{TemplateBinding Padding}"
                                        BorderThickness="1">
                                <Border.BorderBrush>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                        <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                        <GradientStop Color="#FF718597" Offset="0.375"/>
                                        <GradientStop Color="#FF617584" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.BorderBrush>
                                <Border CornerRadius="0">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                            <GradientStop Offset="0" Color="#ffffffff" />
                                            <GradientStop Offset="0.05" Color="#99ffffff" />
                                            <GradientStop Offset="0.95" Color="#44ffffff" />
                                            <GradientStop Offset="1" Color="#00ffffff" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                </Border>
                            </Border>
                        </Grid>

                        <CheckBox x:Name="CheckBox" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="3,6,3,0" Padding="0" />

                        <local:EncodableInputBox x:Name="EncodableInputBox" 
                                                 Grid.Column="1" 
                                                 HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}"                                                                                   
                                                 IsReadOnly="True"
                                                 DropdownMaxHeight="200"
                                                 ItemTemplate="{TemplateBinding ContentTemplate}"
                                                 EncodedItemTemplate="{TemplateBinding EncodedItemTemplate}"
                                                 FlyOutContentTemplate="{TemplateBinding FlyOutContentTemplate}"
                                                 >
                        </local:EncodableInputBox>

                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!-- END MatchingTermItemsControl Styles -->

    <!-- BEGIN IndentedLabel Styles -->
    <Style TargetType="local:IndentedLabel">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:IndentedLabel">
                    <Border Background="{TemplateBinding Background}"
                            Padding="{TemplateBinding Padding}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            >
                        <StackPanel x:Name="StackPanel" HorizontalAlignment="Left" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!-- END IndentedLabel Styles -->

    <!-- BEGIN EncodableInputBox Styles -->
    <Style TargetType="local:EncodableInputBox">
        <Setter Property="Padding" Value="4,4,4,4" />
        <Setter Property="IsSearchButtonVisible" Value="True" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Foreground" Value="#FF000000" />
        <Setter Property="Background" Value="#FFFFFFFF" />
        <Setter Property="MaxLength" Value="255" />
        <Setter Property="WatermarkTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock FontStyle="Italic" Text="{Binding}" Opacity="0.5"
                               TextWrapping="Wrap"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="BorderBrush">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                    <GradientStop Color="#FF718597" Offset="0.375"/>
                    <GradientStop Color="#FF617584" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemContainerStyle">
            <Setter.Value>
                <Style TargetType="ListBoxItem">
                    <Setter Property="Padding" Value="3"/>
                    <Setter Property="HorizontalContentAlignment" Value="Left"/>
                    <Setter Property="VerticalContentAlignment" Value="Top"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListBoxItem">
                                <Grid Background="{TemplateBinding Background}">
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="CommonStates">
                                            <VisualState x:Name="Normal"/>
                                            <VisualState x:Name="MouseOver">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="mouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="Disabled">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetName="contentPresenter" Storyboard.TargetProperty="Opacity">
                                                        <SplineDoubleKeyFrame KeyTime="0" Value=".55"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="SelectionStates">
                                            <VisualState x:Name="Unselected"/>
                                            <VisualState x:Name="Selected">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="selectedBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="FocusStates">
                                            <VisualState x:Name="Focused">
                                                <Storyboard/>
                                            </VisualState>
                                            <VisualState x:Name="Unfocused"/>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <Border HorizontalAlignment="Stretch" Width="Auto" Background="#FFCBF5FF" BorderBrush="#FFABE3F0" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" x:Name="selectedBorder" Opacity="0"/>
                                    <Border HorizontalAlignment="Stretch" Width="Auto" Background="#55CBF5FF" BorderBrush="#55ABE3F0" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" x:Name="mouseOverBorder" Opacity="0"/>
                                    <ContentPresenter HorizontalAlignment="Left" Margin="{TemplateBinding Padding}" x:Name="contentPresenter" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="EncodedButtonStyle">
            <Setter.Value>
                <Style TargetType="Button">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Foreground" Value="#FF000000"/>
                    <Setter Property="Padding" Value="3"/>
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Grid>
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="CommonStates">
                                            <VisualState x:Name="Normal">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="MouseOver">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>

                                            </VisualState>
                                            <VisualState x:Name="Pressed">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="pressedShadow" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="contentGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="contentGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>

                                            </VisualState>
                                            <VisualState x:Name="Disabled">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DisabledVisualElement" Storyboard.TargetProperty="Opacity">
                                                        <SplineDoubleKeyFrame KeyTime="0" Value=".55"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="FocusStates">
                                            <VisualState x:Name="Focused">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="FocusRectangle" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="Unfocused">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="FocusRectangle" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <Border x:Name="Background" Background="{TemplateBinding Background}" CornerRadius="0">
                                        <Grid>
                                            <Border x:Name="MouseOverBorder" Opacity="0" Background="#ffebc822" CornerRadius="0"
                                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" >
                                                <Border CornerRadius="0">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                            <GradientStop Offset="0" Color="#ffffffff" />
                                                            <GradientStop Offset="0.05" Color="#99ffffff" />
                                                            <GradientStop Offset="0.95" Color="#44ffffff" />
                                                            <GradientStop Offset="1" Color="#00ffffff" />
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                </Border>
                                            </Border>

                                            <Rectangle Margin="2" Stroke="#7f000000" StrokeDashArray="2 2" StrokeThickness="1" x:Name="FocusRectangle" Opacity="0" />
                                        </Grid>
                                    </Border>
                                    <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" x:Name="contentGrid" RenderTransformOrigin="0,0" >
                                        <Grid.RenderTransform>
                                            <TransformGroup>
                                                <ScaleTransform/>
                                                <SkewTransform/>
                                                <RotateTransform/>
                                                <TranslateTransform/>
                                            </TransformGroup>
                                        </Grid.RenderTransform>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <ContentPresenter x:Name="contentPresenter" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" />
                                        <Canvas Grid.Column="1" Width="15" Height="15" Margin="5,0,5,0" VerticalAlignment="Center">
                                            <Path Height="7" Width="9" Canvas.Left="3" Canvas.Top="4" Fill="Transparent" Stretch="Fill" 
                                                  Stroke="{TemplateBinding Foreground}" Data="M7.3137746,11.856993 L2.9679401,5.6252456 L12.12423,5.59375 z" StrokeLineJoin="Round"/>
                                        </Canvas>
                                    </Grid>
                                    <Border Margin="0,0,0,0" BorderThickness="{TemplateBinding BorderThickness}" Opacity="0" x:Name="pressedShadow">
                                        <Grid>
                                            <Border Margin="0,0,0,0" VerticalAlignment="Top" Height="5" CornerRadius="0,0,0,0">
                                                <Border.Background>
                                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                        <GradientStop Color="#55000000"/>
                                                        <GradientStop Color="#00000000" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                            <Border Margin="0,0,0,0" HorizontalAlignment="Left" Width="5" CornerRadius="0,0,0,0">
                                                <Border.Background>
                                                    <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                                        <GradientStop Color="#55000000"/>
                                                        <GradientStop Color="#00000000" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                        </Grid>
                                    </Border>
                                    <Rectangle x:Name="DisabledVisualElement" IsHitTestVisible="false" Opacity="0" Fill="#FFFFFFFF" RadiusX="3" RadiusY="3"/>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="HorizontalContentAlignment" Value="Left"/>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="SearchButtonStyle">
            <Setter.Value>
                <Style TargetType="Button">
                    <Setter Property="Background" Value="#FFFFFFFF"/>
                    <Setter Property="Foreground" Value="#FF000000"/>
                    <Setter Property="Padding" Value="3"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="BorderBrush">
                        <Setter.Value>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                <GradientStop Color="#FF718597" Offset="0.375"/>
                                <GradientStop Color="#FF617584" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Grid>

                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="CommonStates">
                                            <VisualState x:Name="Normal">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="MouseOver">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>

                                            </VisualState>
                                            <VisualState x:Name="Pressed">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="pressedShadow" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="contentGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="contentGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>

                                            </VisualState>
                                            <VisualState x:Name="Disabled">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DisabledVisualElement" Storyboard.TargetProperty="Opacity">
                                                        <SplineDoubleKeyFrame KeyTime="0" Value=".55"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="FocusStates">
                                            <VisualState x:Name="Focused">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="FocusBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="0.4"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="Unfocused">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="FocusBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <Border x:Name="Background" Background="{TemplateBinding Background}" CornerRadius="0,3,3,0"
                                            BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                        <Grid>
                                            <Border x:Name="MouseOverBorder" Opacity="0" Background="#ffebc822" CornerRadius="0,2,2,0"                                                    
                                                >
                                                <Border CornerRadius="0">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                            <GradientStop Offset="0" Color="#ffffffff" />
                                                            <GradientStop Offset="0.05" Color="#99ffffff" />
                                                            <GradientStop Offset="0.95" Color="#44ffffff" />
                                                            <GradientStop Offset="1" Color="#00ffffff" />
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                </Border>
                                            </Border>

                                            <Border x:Name="FocusBorder" Opacity="0" Background="#ffebc822" CornerRadius="0,2,2,0">
                                                <Border CornerRadius="0">
                                                    <Border.Background>
                                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                            <GradientStop Offset="0" Color="#ffffffff" />
                                                            <GradientStop Offset="0.05" Color="#99ffffff" />
                                                            <GradientStop Offset="0.95" Color="#44ffffff" />
                                                            <GradientStop Offset="1" Color="#00ffffff" />
                                                        </LinearGradientBrush>
                                                    </Border.Background>
                                                </Border>
                                            </Border>
                                        </Grid>
                                    </Border>
                                    <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" x:Name="contentGrid" RenderTransformOrigin="0,0" >
                                        <Grid.RenderTransform>
                                            <TransformGroup>
                                                <ScaleTransform/>
                                                <SkewTransform/>
                                                <RotateTransform/>
                                                <TranslateTransform/>
                                            </TransformGroup>
                                        </Grid.RenderTransform>

                                        <Canvas Margin="2,0,0,0" Height="18" HorizontalAlignment="Center" VerticalAlignment="Center" Width="18">
                                            <Ellipse Height="12" Width="12" Canvas.Left="6" StrokeThickness="2" Canvas.Top="0">
                                                <Ellipse.Stroke>
                                                    <LinearGradientBrush EndPoint="0.559,0.559" StartPoint="0.146,0.146">
                                                        <GradientStop Color="#FF575757"/>
                                                        <GradientStop Color="#FF000000" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Ellipse.Stroke>
                                                <Ellipse.Fill>
                                                    <LinearGradientBrush EndPoint="0.674,0.674" StartPoint="0.257,0.257">
                                                        <GradientStop Color="#FFFFFFFF"/>
                                                        <GradientStop Color="#4CFFFFFF" Offset="0.688"/>
                                                        <GradientStop Color="#B2FFFFFF" Offset="0.121"/>
                                                        <GradientStop Color="#00FFFFFF" Offset="0.804"/>
                                                    </LinearGradientBrush>
                                                </Ellipse.Fill>
                                            </Ellipse>
                                            <Path Height="9" Width="9" Canvas.Top="9" Fill="#FFFFFFFF" Stretch="Fill" Data="M8.916667,9.166667 L2.331224,15.75211" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeThickness="2">
                                                <Path.Stroke>
                                                    <LinearGradientBrush EndPoint="0.605,0.605" StartPoint="0.146,0.146">
                                                        <GradientStop Color="#FF2D2D2D"/>
                                                        <GradientStop Color="#FF000000" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Path.Stroke>
                                            </Path>
                                        </Canvas>

                                    </Grid>
                                    <Border Margin="0,0,0,0" BorderThickness="{TemplateBinding BorderThickness}" Opacity="0" x:Name="pressedShadow">
                                        <Grid>
                                            <Border Margin="0,0,0,0" VerticalAlignment="Top" Height="5" CornerRadius="0,0,0,0">
                                                <Border.Background>
                                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                        <GradientStop Color="#55000000"/>
                                                        <GradientStop Color="#00000000" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                            <Border Margin="0,0,0,0" HorizontalAlignment="Left" Width="5" CornerRadius="0,0,0,0">
                                                <Border.Background>
                                                    <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                                        <GradientStop Color="#55000000"/>
                                                        <GradientStop Color="#00000000" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                        </Grid>
                                    </Border>
                                    <Rectangle x:Name="DisabledVisualElement" IsHitTestVisible="false" Opacity="0" Fill="#FFFFFFFF" RadiusX="3" RadiusY="3"/>




                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:EncodableInputBox">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBox x:Name="TextBox" Margin="0"
                                 BorderThickness="{TemplateBinding BorderThickness}" 
                                 BorderBrush="{TemplateBinding BorderBrush}"
                                 Foreground="{TemplateBinding Foreground}"
                                 Background="{TemplateBinding Background}"                                 
                                 Padding="{TemplateBinding Padding}"
                                 MaxLength="{TemplateBinding MaxLength}"  
                                 />

                        <Button x:Name="SearchButton" Grid.Column="1"
                                    BorderThickness="{TemplateBinding BorderThickness}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Style="{TemplateBinding SearchButtonStyle}"
                                Background="{TemplateBinding Background}"
                                    Margin="-3,0,0,0"
                                Padding="{TemplateBinding Padding}">
                        </Button>

                        <ContentPresenter x:Name="WatermarkContentPresenter"
                                                  Margin="{TemplateBinding Padding}"
                                                  Content="{TemplateBinding Watermark}"
                                                  ContentTemplate="{TemplateBinding WatermarkTemplate}"
                                                  IsHitTestVisible="False"/>

                        <Button Grid.ColumnSpan="2" Grid.Row="1"
                                Style="{TemplateBinding EncodedButtonStyle}"
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Background="Transparent"
                                x:Name="EncodedButton"
                                Content="{TemplateBinding SelectedItem}"
                                ContentTemplate="{TemplateBinding EncodedItemTemplate}"
                                HorizontalContentAlignment="Stretch"
                                Visibility="Collapsed"
                                Foreground="{TemplateBinding Foreground}"
                                Padding="{TemplateBinding Padding}"
                                VerticalAlignment="Top"
                                />

                        <Canvas Grid.Row="2" VerticalAlignment="Top" Grid.ColumnSpan="2" >
                            <Popup x:Name="Popup" IsOpen="False" MinHeight="200" >
                                <Grid VerticalAlignment="Top" Margin="0,0,0,2">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <Grid x:Name="HidePopupGrid" Margin="0,0,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="0" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="0" />
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="0" />
                                                <RowDefinition Height="*" />
                                                <RowDefinition Height="0" />
                                            </Grid.RowDefinitions>
                                            <Rectangle Fill="Transparent" Grid.ColumnSpan="3" Margin="-5000,-5000,-5000,0" />
                                            <Rectangle Fill="Transparent" Grid.Row="1" Margin="-5000,0,0,0" />
                                            <Rectangle Fill="Transparent" Grid.Row="1" Grid.Column="2" Margin="0,0,-5000,0" />
                                            <Rectangle Fill="Transparent" Grid.Row="2" Grid.ColumnSpan="3" Margin="-5000,0,-5000,-5000" />
                                        </Grid>

                                        <Grid VerticalAlignment="Top">
                                            <Border Background="#22000000" CornerRadius="4">
                                                <Border.RenderTransform>
                                                    <TranslateTransform X="2" Y="2" />
                                                </Border.RenderTransform>
                                            </Border>

                                            <Border x:Name="PopupBorder" 
                                                            MaxHeight="{TemplateBinding DropdownMaxHeight}"
                                                            HorizontalAlignment="Stretch" Opacity="1.0" BorderThickness="0" CornerRadius="3"
                                                            Canvas.ZIndex="1">
                                                <Border.RenderTransform>
                                                    <TranslateTransform X="1" Y="1" />
                                                </Border.RenderTransform>
                                                <Border HorizontalAlignment="Stretch" Opacity="1.0" Padding="0">
                                                    <Border.RenderTransform>
                                                        <TransformGroup>
                                                            <TranslateTransform X="-1" Y="-1" />
                                                        </TransformGroup>
                                                    </Border.RenderTransform>
                                                    <Grid>
                                                        <local:ConceptListBox x:Name="ConceptListBox"
                                                                  ItemTemplate="{TemplateBinding ItemTemplate}"
                                                                  ItemsSource="{TemplateBinding ItemsSource}"
                                                                  BorderThickness="{TemplateBinding BorderThickness}" 
                                                                  BorderBrush="{TemplateBinding BorderBrush}"
                                                                  ItemContainerStyle="{TemplateBinding ItemContainerStyle}"
                                                                  Foreground="{TemplateBinding Foreground}"
                                                                  Background="{TemplateBinding Background}"
                                                                  />
                                                    </Grid>
                                                </Border>
                                            </Border>
                                        </Grid>
                                        <Canvas Width="{TemplateBinding FlyOutWidth}" Canvas.ZIndex="0" Grid.Column="1"
                                                            x:Name="FlyOutCanvas" VerticalAlignment="Top">
                                            <Grid x:Name="FlyOutGrid" Visibility="Collapsed" Canvas.Top="0">
                                                <Border Background="#22000000"
                                                CornerRadius="0,5,5,0">
                                                    <Border.RenderTransform>
                                                        <TranslateTransform X="2" Y="2" />
                                                    </Border.RenderTransform>
                                                </Border>

                                                <Border Width="{TemplateBinding FlyOutWidth}" Background="#FFcbf5ff" 
                                            CornerRadius="0,3,3,0"
                                            BorderBrush="#ffabe3f0" BorderThickness="1,1,1,1"
                                            Margin="-1,0,0,0">
                                                    <ContentPresenter Margin="5" Content="{TemplateBinding FlyOutContent}" ContentTemplate="{TemplateBinding FlyOutContentTemplate}"
                                                          x:Name="FlyOutContentPresenter"/>
                                                </Border>
                                            </Grid>
                                        </Canvas>
                                    </Grid>

                                </Grid>
                            </Popup>
                        </Canvas>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:ConceptListBox">
        <Setter Property="Background" Value="#FFFFFFFF"/>
        <Setter Property="Foreground" Value="#FF000000"/>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="VerticalContentAlignment" Value="Top"/>
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                    <GradientStop Color="#FF718597" Offset="0.375"/>
                    <GradientStop Color="#FF617584" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:ConceptListBox">
                    <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="2">
                        <ScrollViewer Background="{TemplateBinding Background}" BorderBrush="Transparent" BorderThickness="0" Padding="0" x:Name="ScrollViewer"
                                      HorizontalScrollBarVisibility="{TemplateBinding HorizontalScrollBarVisibility}"
                                      VerticalScrollBarVisibility="{TemplateBinding VerticalScrollBarVisibility}">
                            <ItemsPresenter x:Name="ItemsPresenter" Margin="2,2,0,2"/>
                        </ScrollViewer>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!-- END EncodableInputBox Styles -->

    <!-- BEGIN DecoratorTextBox Styles -->
    <Style TargetType="local:DecoratorTextBox">
        <Setter Property="Padding" Value="4,4,4,4" />
        <Setter Property="Background" Value="#FFFFFFFF" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="BorderBrush">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                    <GradientStop Color="#FF718597" Offset="0.375"/>
                    <GradientStop Color="#FF617584" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="WatermarkTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock FontStyle="Italic" Text="{Binding}" Opacity="0.5"
                               TextWrapping="Wrap"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:DecoratorTextBox">
                    <Border BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Background="{TemplateBinding Background}">
                        <ScrollViewer x:Name="ScrollViewer" VerticalScrollBarVisibility="Auto"  Padding="0" IsTabStop="False"
                                      BorderThickness="0">
                            <Grid>
                                <Border Margin="{TemplateBinding Padding}">
                                    <Border Margin="{TemplateBinding BorderThickness}">
                                        <local:DecoratorItemsControl x:Name="DecoratorItemsControl"
                                                                     IsTabStop="False"
                                                                     IsHitTestVisible="False"
                                                                     DisplayMemberPath="Text" 
                                                                     Foreground="Transparent"
                                                                     DecoratorItemContainerStyle="{TemplateBinding DecoratorItemContainerStyle}"                                                                     
                                                             />

                                    </Border>
                                </Border>

                                <TextBox Padding="{TemplateBinding Padding}" x:Name="TextBox"
                                         Foreground="{TemplateBinding Foreground}"
                                         Background="Transparent"
                                         BorderThickness="0"
                                         TextWrapping="Wrap"
                                         MaxLength="{TemplateBinding MaxLength}"
                                         IsReadOnly="{TemplateBinding IsReadOnly}"                                                                               
                                 />

                                <ContentPresenter x:Name="WatermarkContentPresenter"
                                                  Margin="{TemplateBinding Padding}"
                                                  Content="{TemplateBinding Watermark}"
                                                  ContentTemplate="{TemplateBinding WatermarkTemplate}"
                                                  IsHitTestVisible="False"/>


                            </Grid>
                        </ScrollViewer>


                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:DecoratorItemsControl">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:DecoratorItemsControl">
                    <ItemsPresenter />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemsPanel">
            <Setter.Value>
                <ItemsPanelTemplate>
                    <local:DecoratorItemsWrapPanel />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:DecoratorItemContainer">
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:DecoratorItemContainer">
                    <Grid>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Disabled"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="EncodeStates">
                                <VisualState x:Name="Normal" />
                                <VisualState x:Name="Encodable">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Encoded">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="PositionStates">
                                <VisualState x:Name="None"/>
                                <VisualState x:Name="Only">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableOnlyBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedOnlyBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightOnlyBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightOnlyBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Start">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableStartBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedStartBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightStartBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightStartBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Middle">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableMiddleBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedMiddleBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightMiddleBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightMiddleBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="End">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableEndBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedEndBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightEndBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightEndBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="MouseHighlightStates">
                                <VisualState x:Name="MouseUnhighlighted">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="MouseHighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="MouseHighlighted">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusHighlightStates">
                                <VisualState x:Name="FocusUnhighlighted">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="FocusHighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="FocusHighlighted">
                                    <Storyboard>
                                        <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                            <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                        </DoubleAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <Grid x:Name="EndcodableGrid" Margin="-0.5,0,0,-0.5" Opacity="0">
                            <Border x:Name="EndcodableOnlyBorder" Opacity="0" Background="#FFcbf5ff" BorderBrush="#ffabe3f0" BorderThickness="1,1,1,1" CornerRadius="3" />
                            <Border x:Name="EndcodableStartBorder" Opacity="0" Background="#FFcbf5ff" BorderBrush="#ffabe3f0" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" />
                            <Border x:Name="EndcodableMiddleBorder" Opacity="0" Background="#FFcbf5ff" BorderBrush="#ffabe3f0" BorderThickness="0,1,0,1" />
                            <Border x:Name="EndcodableEndBorder" Opacity="0" Background="#FFcbf5ff" BorderBrush="#ffabe3f0" BorderThickness="0,1,1,1" CornerRadius="0,3,3,0" />
                        </Grid>

                        <Grid x:Name="EndcodedGrid" Margin="-0.5,0,0,-0.5" Opacity="0">
                            <Border x:Name="EndcodedOnlyBorder" Opacity="0" Background="#FFc4c4c4" BorderBrush="#ff999999" BorderThickness="1,1,1,1" CornerRadius="3" />
                            <Border x:Name="EndcodedStartBorder" Opacity="0" Background="#FFc4c4c4" BorderBrush="#ff999999" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" />
                            <Border x:Name="EndcodedMiddleBorder" Opacity="0" Background="#FFc4c4c4" BorderBrush="#ff999999" BorderThickness="0,1,0,1" />
                            <Border x:Name="EndcodedEndBorder" Opacity="0" Background="#FFc4c4c4" BorderBrush="#ff999999" BorderThickness="0,1,1,1" CornerRadius="0,3,3,0" />
                        </Grid>

                        <Grid x:Name="FocusHighlightGrid" Margin="-1,-1,-1,-1" Opacity="0">
                            <Border x:Name="FocusHighlightOnlyBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="1" CornerRadius="3" />
                            <Border x:Name="FocusHighlightStartBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" />
                            <Border x:Name="FocusHighlightMiddleBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="0,1,0,1"  />
                            <Border x:Name="FocusHighlightEndBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="0,1,1,1"  CornerRadius="0,3,3,0" />
                        </Grid>

                        <Grid x:Name="MouseHighlightGrid" Margin="-3,-3,-3,-3" Opacity="0">
                            <Border x:Name="MouseHighlightOnlyBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="3" CornerRadius="3" />
                            <Border x:Name="MouseHighlightStartBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="3,3,0,3" CornerRadius="3,0,0,3" />
                            <Border x:Name="MouseHighlightMiddleBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="0,3,0,3"  />
                            <Border x:Name="MouseHighlightEndBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="0,3,3,3"  CornerRadius="0,3,3,0" />
                        </Grid>

                        <ContentPresenter x:Name="ContentPresenter"/>

                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!-- END DecoratorTextBox Styles -->

    <Style TargetType="local:SingleConceptMatching">
        <Setter Property="InputBoxSearchButtonToolTip" Value="Start search" />
        <Setter Property="AdditionalTextBoxWatermark" Value="If required, please enter additional qualifier text here" />
        <Setter Property="AdditionalTextBoxWatermarkTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock FontStyle="Italic" Text="{Binding}" Opacity="0.5"
                               TextWrapping="Wrap"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="AdditionalTextBoxMaxLength" Value="255" />
        <Setter Property="InputBoxWatermark" Value="Enter term for searching" />
        <Setter Property="InputBoxWatermarkTemplate">
            <Setter.Value>
                <DataTemplate>
                    <TextBlock FontStyle="Italic" Text="{Binding}" Opacity="0.5"
                               TextWrapping="Wrap"/>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="InputBoxItemContainerStyle">
            <Setter.Value>
                <Style TargetType="ListBoxItem">
                    <Setter Property="Padding" Value="3"/>
                    <Setter Property="HorizontalContentAlignment" Value="Left"/>
                    <Setter Property="VerticalContentAlignment" Value="Top"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="ListBoxItem">
                                <Grid Background="{TemplateBinding Background}">
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="CommonStates">
                                            <VisualState x:Name="Normal"/>
                                            <VisualState x:Name="MouseOver" />
                                            <VisualState x:Name="Disabled">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetName="contentPresenter" Storyboard.TargetProperty="Opacity">
                                                        <SplineDoubleKeyFrame KeyTime="0" Value=".55"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="SelectionStates">
                                            <VisualState x:Name="Unselected"/>
                                            <VisualState x:Name="Selected">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="selectedBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="FocusStates">
                                            <VisualState x:Name="Focused">
                                                <Storyboard/>
                                            </VisualState>
                                            <VisualState x:Name="Unfocused"/>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <Border HorizontalAlignment="Stretch" Width="Auto" Background="#FFCBF5FF" BorderBrush="#FFABE3F0" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" x:Name="selectedBorder" Opacity="0"/>
                                    <ContentPresenter HorizontalAlignment="Left" Margin="{TemplateBinding Padding}" x:Name="contentPresenter" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="AdditionalTextBoxDecoratorItemContainerStyle">
            <Setter.Value>
                <Style TargetType="local:DecoratorItemContainer">
                    <Setter Property="IsTabStop" Value="False" />
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="local:DecoratorItemContainer">
                                <Grid>
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="CommonStates">
                                            <VisualState x:Name="Disabled"/>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="EncodeStates">
                                            <VisualState x:Name="Normal" />
                                            <VisualState x:Name="Encodable">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="Encoded">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="PositionStates">
                                            <VisualState x:Name="None"/>
                                            <VisualState x:Name="Only">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableOnlyBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedOnlyBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightOnlyBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightOnlyBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="Start">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableStartBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedStartBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightStartBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightStartBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="Middle">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableMiddleBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedMiddleBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightMiddleBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightMiddleBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="End">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodableEndBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="EndcodedEndBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightEndBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightEndBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="MouseHighlightStates">
                                            <VisualState x:Name="MouseUnhighlighted">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="MouseHighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="MouseHighlighted">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseHighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="FocusHighlightStates">
                                            <VisualState x:Name="FocusUnhighlighted">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="FocusHighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="FocusHighlighted">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="FocusHighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>

                                    <Grid x:Name="EndcodableGrid" Margin="-0.5,0,0,-0.5" Opacity="0">
                                        <Border x:Name="EndcodableOnlyBorder" Opacity="0" Background="#FFcbf5ff" BorderBrush="#ffabe3f0" BorderThickness="1,1,1,1" CornerRadius="3" />
                                        <Border x:Name="EndcodableStartBorder" Opacity="0" Background="#FFcbf5ff" BorderBrush="#ffabe3f0" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" />
                                        <Border x:Name="EndcodableMiddleBorder" Opacity="0" Background="#FFcbf5ff" BorderBrush="#ffabe3f0" BorderThickness="0,1,0,1" />
                                        <Border x:Name="EndcodableEndBorder" Opacity="0" Background="#FFcbf5ff" BorderBrush="#ffabe3f0" BorderThickness="0,1,1,1" CornerRadius="0,3,3,0" />
                                    </Grid>

                                    <Grid x:Name="EndcodedGrid" Margin="-0.5,0,0,-0.5" Opacity="0">
                                        <Border x:Name="EndcodedOnlyBorder" Opacity="0" Background="#FFc4c4c4" BorderBrush="#ff999999" BorderThickness="1,1,1,1" CornerRadius="3" />
                                        <Border x:Name="EndcodedStartBorder" Opacity="0" Background="#FFc4c4c4" BorderBrush="#ff999999" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" />
                                        <Border x:Name="EndcodedMiddleBorder" Opacity="0" Background="#FFc4c4c4" BorderBrush="#ff999999" BorderThickness="0,1,0,1" />
                                        <Border x:Name="EndcodedEndBorder" Opacity="0" Background="#FFc4c4c4" BorderBrush="#ff999999" BorderThickness="0,1,1,1" CornerRadius="0,3,3,0" />
                                    </Grid>

                                    <Grid x:Name="FocusHighlightGrid" Margin="-1,-1,-1,-1" Opacity="0">
                                        <Border x:Name="FocusHighlightOnlyBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="1" CornerRadius="3" />
                                        <Border x:Name="FocusHighlightStartBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" />
                                        <Border x:Name="FocusHighlightMiddleBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="0,1,0,1"  />
                                        <Border x:Name="FocusHighlightEndBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="0,1,1,1"  CornerRadius="0,3,3,0" />
                                    </Grid>

                                    <Grid x:Name="MouseHighlightGrid" Margin="-3,-3,-3,-3" Opacity="0">
                                        <Border x:Name="MouseHighlightOnlyBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="3" CornerRadius="3" />
                                        <Border x:Name="MouseHighlightStartBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="3,3,0,3" CornerRadius="3,0,0,3" />
                                        <Border x:Name="MouseHighlightMiddleBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="0,3,0,3"  />
                                        <Border x:Name="MouseHighlightEndBorder" Opacity="0" BorderBrush="#ffebc822" BorderThickness="0,3,3,3"  CornerRadius="0,3,3,0" />
                                    </Grid>

                                    <ContentPresenter x:Name="ContentPresenter"/>

                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="InputBoxStyle">
            <Setter.Value>
                <Style TargetType="local:EncodableInputBox">
                    <Setter Property="Padding" Value="4,4,4,4" />
                    <Setter Property="IsSearchButtonVisible" Value="True" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="Foreground" Value="#FF000000" />
                    <Setter Property="Background" Value="#FFFFFFFF" />
                    <Setter Property="MaxLength" Value="255" />
                    <Setter Property="WatermarkTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <TextBlock FontStyle="Italic" Text="{Binding}" Opacity="0.5"
                               TextWrapping="Wrap"/>
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="BorderBrush">
                        <Setter.Value>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                <GradientStop Color="#FF718597" Offset="0.375"/>
                                <GradientStop Color="#FF617584" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="ItemContainerStyle">
                        <Setter.Value>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="Padding" Value="3"/>
                                <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                <Setter Property="VerticalContentAlignment" Value="Top"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="BorderThickness" Value="1"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListBoxItem">
                                            <Grid Background="{TemplateBinding Background}">
                                                <VisualStateManager.VisualStateGroups>
                                                    <VisualStateGroup x:Name="CommonStates">
                                                        <VisualState x:Name="Normal"/>
                                                        <VisualState x:Name="MouseOver">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="mouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="Disabled">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="contentPresenter" Storyboard.TargetProperty="Opacity">
                                                                    <SplineDoubleKeyFrame KeyTime="0" Value=".55"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                    </VisualStateGroup>
                                                    <VisualStateGroup x:Name="SelectionStates">
                                                        <VisualState x:Name="Unselected"/>
                                                        <VisualState x:Name="Selected">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="selectedBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                    </VisualStateGroup>
                                                    <VisualStateGroup x:Name="FocusStates">
                                                        <VisualState x:Name="Focused">
                                                            <Storyboard/>
                                                        </VisualState>
                                                        <VisualState x:Name="Unfocused"/>
                                                    </VisualStateGroup>
                                                </VisualStateManager.VisualStateGroups>
                                                <Border HorizontalAlignment="Stretch" Width="Auto" Background="#FFCBF5FF" BorderBrush="#FFABE3F0" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" x:Name="selectedBorder" Opacity="0"/>
                                                <Border HorizontalAlignment="Stretch" Width="Auto" Background="#55CBF5FF" BorderBrush="#55ABE3F0" BorderThickness="1,1,0,1" CornerRadius="3,0,0,3" x:Name="mouseOverBorder" Opacity="0"/>
                                                <ContentPresenter HorizontalAlignment="Left" Margin="{TemplateBinding Padding}" x:Name="contentPresenter" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                            </Grid>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="EncodedButtonStyle">
                        <Setter.Value>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Foreground" Value="#FF000000"/>
                                <Setter Property="Padding" Value="3"/>
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Grid>
                                                <VisualStateManager.VisualStateGroups>
                                                    <VisualStateGroup x:Name="CommonStates">
                                                        <VisualState x:Name="Normal">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="MouseOver">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>

                                                        </VisualState>
                                                        <VisualState x:Name="Pressed">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="pressedShadow" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="contentGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="contentGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>

                                                        </VisualState>
                                                        <VisualState x:Name="Disabled">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DisabledVisualElement" Storyboard.TargetProperty="Opacity">
                                                                    <SplineDoubleKeyFrame KeyTime="0" Value=".55"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                    </VisualStateGroup>
                                                    <VisualStateGroup x:Name="FocusStates">
                                                        <VisualState x:Name="Focused">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="FocusRectangle" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="Unfocused">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="FocusRectangle" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="0"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                    </VisualStateGroup>
                                                </VisualStateManager.VisualStateGroups>
                                                <Border x:Name="Background" Background="{TemplateBinding Background}" CornerRadius="0">
                                                    <Grid>
                                                        <Border x:Name="MouseOverBorder" Opacity="0" Background="#ffebc822" CornerRadius="0"
                                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" >
                                                            <Border CornerRadius="0">
                                                                <Border.Background>
                                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                                        <GradientStop Offset="0" Color="#ffffffff" />
                                                                        <GradientStop Offset="0.05" Color="#99ffffff" />
                                                                        <GradientStop Offset="0.95" Color="#44ffffff" />
                                                                        <GradientStop Offset="1" Color="#00ffffff" />
                                                                    </LinearGradientBrush>
                                                                </Border.Background>
                                                            </Border>
                                                        </Border>

                                                        <Rectangle Margin="2" Stroke="#7f000000" StrokeDashArray="2 2" StrokeThickness="1" x:Name="FocusRectangle" Opacity="0" />
                                                    </Grid>
                                                </Border>
                                                <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" x:Name="contentGrid" RenderTransformOrigin="0,0" >
                                                    <Grid.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform/>
                                                            <SkewTransform/>
                                                            <RotateTransform/>
                                                            <TranslateTransform/>
                                                        </TransformGroup>
                                                    </Grid.RenderTransform>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <ContentPresenter x:Name="contentPresenter" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" />
                                                    <Canvas Grid.Column="1" Width="15" Height="15" Margin="5,0,5,0" VerticalAlignment="Center">
                                                        <Path Height="7" Width="9" Canvas.Left="3" Canvas.Top="4" Fill="Transparent" Stretch="Fill" 
                                                  Stroke="{TemplateBinding Foreground}" Data="M7.3137746,11.856993 L2.9679401,5.6252456 L12.12423,5.59375 z" StrokeLineJoin="Round"/>
                                                    </Canvas>
                                                </Grid>
                                                <Border Margin="0,0,0,0" BorderThickness="{TemplateBinding BorderThickness}" Opacity="0" x:Name="pressedShadow">
                                                    <Grid>
                                                        <Border Margin="0,0,0,0" VerticalAlignment="Top" Height="5" CornerRadius="0,0,0,0">
                                                            <Border.Background>
                                                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                    <GradientStop Color="#55000000"/>
                                                                    <GradientStop Color="#00000000" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Border.Background>
                                                        </Border>
                                                        <Border Margin="0,0,0,0" HorizontalAlignment="Left" Width="5" CornerRadius="0,0,0,0">
                                                            <Border.Background>
                                                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                                                    <GradientStop Color="#55000000"/>
                                                                    <GradientStop Color="#00000000" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Border.Background>
                                                        </Border>
                                                    </Grid>
                                                </Border>
                                                <Rectangle x:Name="DisabledVisualElement" IsHitTestVisible="false" Opacity="0" Fill="#FFFFFFFF" RadiusX="3" RadiusY="3"/>
                                            </Grid>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="HorizontalContentAlignment" Value="Left"/>
                            </Style>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="SearchButtonStyle">
                        <Setter.Value>
                            <Style TargetType="Button">
                                <Setter Property="Background" Value="#FFFFFFFF"/>
                                <Setter Property="Foreground" Value="#FF000000"/>
                                <Setter Property="Padding" Value="3"/>
                                <Setter Property="BorderThickness" Value="1"/>
                                <Setter Property="BorderBrush">
                                    <Setter.Value>
                                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                            <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                            <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                            <GradientStop Color="#FF718597" Offset="0.375"/>
                                            <GradientStop Color="#FF617584" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Grid>

                                                <VisualStateManager.VisualStateGroups>
                                                    <VisualStateGroup x:Name="CommonStates">
                                                        <VisualState x:Name="Normal">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="MouseOver">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>

                                                        </VisualState>
                                                        <VisualState x:Name="Pressed">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="pressedShadow" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="contentGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="contentGrid" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MouseOverBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>

                                                        </VisualState>
                                                        <VisualState x:Name="Disabled">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames Storyboard.TargetName="DisabledVisualElement" Storyboard.TargetProperty="Opacity">
                                                                    <SplineDoubleKeyFrame KeyTime="0" Value=".55"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                    </VisualStateGroup>
                                                    <VisualStateGroup x:Name="FocusStates">
                                                        <VisualState x:Name="Focused">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="FocusBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00.0000000" Value="0.4"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                        <VisualState x:Name="Unfocused">
                                                            <Storyboard>
                                                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="FocusBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                                    <SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
                                                                </DoubleAnimationUsingKeyFrames>
                                                            </Storyboard>
                                                        </VisualState>
                                                    </VisualStateGroup>
                                                </VisualStateManager.VisualStateGroups>
                                                <Border x:Name="Background" Background="{TemplateBinding Background}" CornerRadius="0,3,3,0"
                                            BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                                    <Grid>
                                                        <Border x:Name="MouseOverBorder" Opacity="0" Background="#ffebc822" CornerRadius="0,2,2,0"                                                    
                                                >
                                                            <Border CornerRadius="0">
                                                                <Border.Background>
                                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                                        <GradientStop Offset="0" Color="#ffffffff" />
                                                                        <GradientStop Offset="0.05" Color="#99ffffff" />
                                                                        <GradientStop Offset="0.95" Color="#44ffffff" />
                                                                        <GradientStop Offset="1" Color="#00ffffff" />
                                                                    </LinearGradientBrush>
                                                                </Border.Background>
                                                            </Border>
                                                        </Border>

                                                        <Border x:Name="FocusBorder" Opacity="0" Background="#ffebc822" CornerRadius="0,2,2,0">
                                                            <Border CornerRadius="0">
                                                                <Border.Background>
                                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                                        <GradientStop Offset="0" Color="#ffffffff" />
                                                                        <GradientStop Offset="0.05" Color="#99ffffff" />
                                                                        <GradientStop Offset="0.95" Color="#44ffffff" />
                                                                        <GradientStop Offset="1" Color="#00ffffff" />
                                                                    </LinearGradientBrush>
                                                                </Border.Background>
                                                            </Border>
                                                        </Border>
                                                    </Grid>
                                                </Border>
                                                <Grid HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" x:Name="contentGrid" RenderTransformOrigin="0,0" >
                                                    <Grid.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform/>
                                                            <SkewTransform/>
                                                            <RotateTransform/>
                                                            <TranslateTransform/>
                                                        </TransformGroup>
                                                    </Grid.RenderTransform>

                                                    <Canvas Margin="2,0,0,0" Height="18" HorizontalAlignment="Center" VerticalAlignment="Center" Width="18">
                                                        <Ellipse Height="12" Width="12" Canvas.Left="6" StrokeThickness="2" Canvas.Top="0">
                                                            <Ellipse.Stroke>
                                                                <LinearGradientBrush EndPoint="0.559,0.559" StartPoint="0.146,0.146">
                                                                    <GradientStop Color="#FF575757"/>
                                                                    <GradientStop Color="#FF000000" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Ellipse.Stroke>
                                                            <Ellipse.Fill>
                                                                <LinearGradientBrush EndPoint="0.674,0.674" StartPoint="0.257,0.257">
                                                                    <GradientStop Color="#FFFFFFFF"/>
                                                                    <GradientStop Color="#4CFFFFFF" Offset="0.688"/>
                                                                    <GradientStop Color="#B2FFFFFF" Offset="0.121"/>
                                                                    <GradientStop Color="#00FFFFFF" Offset="0.804"/>
                                                                </LinearGradientBrush>
                                                            </Ellipse.Fill>
                                                        </Ellipse>
                                                        <Path Height="9" Width="9" Canvas.Top="9" Fill="#FFFFFFFF" Stretch="Fill" Data="M8.916667,9.166667 L2.331224,15.75211" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeThickness="2">
                                                            <Path.Stroke>
                                                                <LinearGradientBrush EndPoint="0.605,0.605" StartPoint="0.146,0.146">
                                                                    <GradientStop Color="#FF2D2D2D"/>
                                                                    <GradientStop Color="#FF000000" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Path.Stroke>
                                                        </Path>
                                                    </Canvas>

                                                </Grid>
                                                <Border Margin="0,0,0,0" BorderThickness="{TemplateBinding BorderThickness}" Opacity="0" x:Name="pressedShadow">
                                                    <Grid>
                                                        <Border Margin="0,0,0,0" VerticalAlignment="Top" Height="5" CornerRadius="0,0,0,0">
                                                            <Border.Background>
                                                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                    <GradientStop Color="#55000000"/>
                                                                    <GradientStop Color="#00000000" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Border.Background>
                                                        </Border>
                                                        <Border Margin="0,0,0,0" HorizontalAlignment="Left" Width="5" CornerRadius="0,0,0,0">
                                                            <Border.Background>
                                                                <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                                                    <GradientStop Color="#55000000"/>
                                                                    <GradientStop Color="#00000000" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Border.Background>
                                                        </Border>
                                                    </Grid>
                                                </Border>
                                                <Rectangle x:Name="DisabledVisualElement" IsHitTestVisible="false" Opacity="0" Fill="#FFFFFFFF" RadiusX="3" RadiusY="3"/>




                                            </Grid>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="local:EncodableInputBox">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBox x:Name="TextBox" Margin="0"
                                 BorderThickness="{TemplateBinding BorderThickness}" 
                                 BorderBrush="{TemplateBinding BorderBrush}"
                                 Foreground="{TemplateBinding Foreground}"
                                 Background="{TemplateBinding Background}"                                 
                                 Padding="{TemplateBinding Padding}"
                                 MaxLength="{TemplateBinding MaxLength}"    
                                 />

                                    <Button x:Name="SearchButton" Grid.Column="1"
                                    BorderThickness="{TemplateBinding BorderThickness}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Style="{TemplateBinding SearchButtonStyle}"
                                Background="{TemplateBinding Background}"
                                    Margin="-3,0,0,0"
                                Padding="{TemplateBinding Padding}">
                                    </Button>

                                    <ContentPresenter x:Name="WatermarkContentPresenter"
                                                  Margin="{TemplateBinding Padding}"
                                                  Content="{TemplateBinding Watermark}"
                                                  ContentTemplate="{TemplateBinding WatermarkTemplate}"
                                                  IsHitTestVisible="False"/>

                                    <Button Grid.ColumnSpan="2" Grid.Row="1"
                                Style="{TemplateBinding EncodedButtonStyle}"
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Background="Transparent"
                                x:Name="EncodedButton"
                                Content="{TemplateBinding SelectedItem}"
                                ContentTemplate="{TemplateBinding EncodedItemTemplate}"
                                HorizontalContentAlignment="Stretch"
                                Visibility="Collapsed"
                                Foreground="{TemplateBinding Foreground}"
                                Padding="{TemplateBinding Padding}"
                                VerticalAlignment="Top"
                                />

                                    <Canvas Grid.Row="2" VerticalAlignment="Top" Grid.ColumnSpan="2" >
                                        <Popup x:Name="Popup" IsOpen="False" MinHeight="200" >
                                            <Grid VerticalAlignment="Top" Margin="0,0,0,2">                                                
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <Grid x:Name="HidePopupGrid" Margin="0,0,0,0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="0" />
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="0" />
                                                        </Grid.ColumnDefinitions>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="0" />
                                                            <RowDefinition Height="*" />
                                                            <RowDefinition Height="0" />
                                                        </Grid.RowDefinitions>
                                                        <Rectangle Fill="Transparent" Grid.ColumnSpan="3" Margin="-5000,-5000,-5000,0" />
                                                        <Rectangle Fill="Transparent" Grid.Row="1" Margin="-5000,0,0,0" />
                                                        <Rectangle Fill="Transparent" Grid.Row="1" Grid.Column="2" Margin="0,0,-5000,0" />
                                                        <Rectangle Fill="Transparent" Grid.Row="2" Grid.ColumnSpan="3" Margin="-5000,0,-5000,-5000" />
                                                    </Grid>

                                                    <Grid VerticalAlignment="Top">
                                                        <Border Background="#22000000" CornerRadius="4">
                                                            <Border.RenderTransform>
                                                                <TranslateTransform X="2" Y="2" />
                                                            </Border.RenderTransform>
                                                        </Border>

                                                        <Border x:Name="PopupBorder" 
                                                            MaxHeight="{TemplateBinding DropdownMaxHeight}"
                                                            HorizontalAlignment="Stretch" Opacity="1.0" BorderThickness="0" CornerRadius="3"
                                                            Canvas.ZIndex="1">
                                                            <Border.RenderTransform>
                                                                <TranslateTransform X="1" Y="1" />
                                                            </Border.RenderTransform>
                                                            <Border HorizontalAlignment="Stretch" Opacity="1.0" Padding="0">
                                                                <Border.RenderTransform>
                                                                    <TransformGroup>
                                                                        <TranslateTransform X="-1" Y="-1" />
                                                                    </TransformGroup>
                                                                </Border.RenderTransform>
                                                                <Grid>
                                                                    <local:ConceptListBox x:Name="ConceptListBox"
                                                                  ItemTemplate="{TemplateBinding ItemTemplate}"
                                                                  ItemsSource="{TemplateBinding ItemsSource}"
                                                                  BorderThickness="{TemplateBinding BorderThickness}" 
                                                                  BorderBrush="{TemplateBinding BorderBrush}"
                                                                  ItemContainerStyle="{TemplateBinding ItemContainerStyle}"
                                                                  Foreground="{TemplateBinding Foreground}"
                                                                  Background="{TemplateBinding Background}"
                                                                  />
                                                                </Grid>
                                                            </Border>
                                                        </Border>
                                                    </Grid>
                                                    <Canvas Width="{TemplateBinding FlyOutWidth}" Canvas.ZIndex="0" Grid.Column="1"
                                                            x:Name="FlyOutCanvas" VerticalAlignment="Top">
                                                        <Grid x:Name="FlyOutGrid" Visibility="Collapsed" Canvas.Top="0">
                                                            <Border Background="#22000000"
                                                CornerRadius="0,5,5,0">
                                                                <Border.RenderTransform>
                                                                    <TranslateTransform X="2" Y="2" />
                                                                </Border.RenderTransform>
                                                            </Border>

                                                            <Border Width="{TemplateBinding FlyOutWidth}" Background="#FFcbf5ff" 
                                            CornerRadius="0,3,3,0"
                                            BorderBrush="#ffabe3f0" BorderThickness="1,1,1,1"
                                            Margin="-1,0,0,0">
                                                                <ContentPresenter Margin="5" Content="{TemplateBinding FlyOutContent}" ContentTemplate="{TemplateBinding FlyOutContentTemplate}"
                                                          x:Name="FlyOutContentPresenter"/>
                                                            </Border>
                                                        </Grid>
                                                    </Canvas>
                                                </Grid>

                                            </Grid>
                                        </Popup>
                                    </Canvas>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="AdditionalTextBoxStyle">
            <Setter.Value>
                <Style TargetType="local:DecoratorTextBox">
                    <Setter Property="Padding" Value="4,4,4,4" />
                    <Setter Property="Background" Value="#FFFFFFFF" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="BorderBrush">
                        <Setter.Value>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                <GradientStop Color="#FF718597" Offset="0.375"/>
                                <GradientStop Color="#FF617584" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="WatermarkTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <TextBlock FontStyle="Italic" Text="{Binding}" Opacity="0.5"
                               TextWrapping="Wrap"/>
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="local:DecoratorTextBox">
                                <Border BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Background="{TemplateBinding Background}">
                                    <ScrollViewer x:Name="ScrollViewer" VerticalScrollBarVisibility="Auto"  Padding="0" IsTabStop="False"
                                      BorderThickness="0">
                                        <Grid>
                                            <Border Margin="{TemplateBinding Padding}">
                                                <Border Margin="{TemplateBinding BorderThickness}">
                                                    <local:DecoratorItemsControl x:Name="DecoratorItemsControl"
                                                                     IsTabStop="False"
                                                                     IsHitTestVisible="False"
                                                                     DisplayMemberPath="Text" 
                                                                     Foreground="Transparent"
                                                                     DecoratorItemContainerStyle="{TemplateBinding DecoratorItemContainerStyle}"                                                                     
                                                             />

                                                </Border>
                                            </Border>

                                            <TextBox Padding="{TemplateBinding Padding}" x:Name="TextBox"
                                                     Foreground="{TemplateBinding Foreground}"
                                         Background="Transparent"
                                         BorderThickness="0"
                                         TextWrapping="Wrap"
                                         MaxLength="{TemplateBinding MaxLength}"
                                         IsReadOnly="{TemplateBinding IsReadOnly}"                                                                              
                                 />

                                            <ContentPresenter x:Name="WatermarkContentPresenter"
                                                  Margin="{TemplateBinding Padding}"
                                                  Content="{TemplateBinding Watermark}"
                                                  ContentTemplate="{TemplateBinding WatermarkTemplate}"
                                                  IsHitTestVisible="False"/>


                                        </Grid>
                                    </ScrollViewer>


                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="MatchingTermItemsControlItemContainerStyle">
            <Setter.Value>
                <Style TargetType="local:MatchingTermItemContainer">
                    <Setter Property="Background" Value="#FF448DCA"/>
                    <Setter Property="Foreground" Value="#FF000000"/>
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="VerticalContentAlignment" Value="Top"/>
                    <Setter Property="Padding" Value="1,1,0,0"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="BorderBrush">
                        <Setter.Value>
                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                <GradientStop Color="#FF718597" Offset="0.375"/>
                                <GradientStop Color="#FF617584" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="local:MatchingTermItemContainer">
                                <Grid Margin="0,0,1,0">
                                    <VisualStateManager.VisualStateGroups>
                                        <VisualStateGroup x:Name="CommonStates">
                                            <VisualState x:Name="Normal">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="MouseOverGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>                                            
                                            <VisualState x:Name="Disabled" />
                                        </VisualStateGroup>                                        
                                        <VisualStateGroup x:Name="FocusStates">
                                            <VisualState x:Name="Focused" />
                                            <VisualState x:Name="Unfocused" />
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="ControlFocusStates">
                                            <VisualState x:Name="NoFocus" />
                                            <VisualState x:Name="CheckBoxFocused">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="CheckBoxFocusRectangle" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="EncodableInputBoxFocused" />
                                        </VisualStateGroup>
                                        <VisualStateGroup x:Name="HighlightStates">
                                            <VisualState x:Name="Unhighlighted">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.5" Storyboard.TargetName="HighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00.2" Value="0"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                            <VisualState x:Name="Highlighted">
                                                <Storyboard>
                                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="HighlightGrid" Storyboard.TargetProperty="(UIElement.Opacity)">
                                                        <SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </VisualState>
                                        </VisualStateGroup>
                                    </VisualStateManager.VisualStateGroups>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Grid x:Name="MouseOverGrid" Opacity="0" Grid.Column="1">
                                        <Border Background="#ffebc822" CornerRadius="0"
                                        Margin="{TemplateBinding Padding}"
                                        BorderThickness="1">
                                            <Border.BorderBrush>
                                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                                    <GradientStop Color="#FF718597" Offset="0.375"/>
                                                    <GradientStop Color="#FF617584" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.BorderBrush>
                                            <Border CornerRadius="0">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                        <GradientStop Offset="0" Color="#ffffffff" />
                                                        <GradientStop Offset="0.05" Color="#99ffffff" />
                                                        <GradientStop Offset="0.95" Color="#44ffffff" />
                                                        <GradientStop Offset="1" Color="#00ffffff" />
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                        </Border>
                                    </Grid>

                                    <Rectangle Margin="0,3,0,3" Stroke="#7f000000" StrokeDashArray="2 2" StrokeThickness="1" x:Name="CheckBoxFocusRectangle" Opacity="0"
                                               />

                                    <Grid x:Name="HighlightGrid" Opacity="0" Grid.Column="1">
                                        <Border Background="#ffebc822" CornerRadius="0"
                                        Margin="{TemplateBinding Padding}"
                                        BorderThickness="1">
                                            <Border.BorderBrush>
                                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                    <GradientStop Color="#FFA3AEB9" Offset="0"/>
                                                    <GradientStop Color="#FF8399A9" Offset="0.375"/>
                                                    <GradientStop Color="#FF718597" Offset="0.375"/>
                                                    <GradientStop Color="#FF617584" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.BorderBrush>
                                            <Border CornerRadius="0">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,0.5">
                                                        <GradientStop Offset="0" Color="#ffffffff" />
                                                        <GradientStop Offset="0.05" Color="#99ffffff" />
                                                        <GradientStop Offset="0.95" Color="#44ffffff" />
                                                        <GradientStop Offset="1" Color="#00ffffff" />
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                            </Border>
                                        </Border>
                                    </Grid>
                                    
                                    <CheckBox x:Name="CheckBox" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="3,6,3,0" Padding="0" />

                                    <local:EncodableInputBox x:Name="EncodableInputBox" 
                                                 Grid.Column="1" 
                                                 HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}"                                                                                   
                                                 IsReadOnly="True"
                                                 DropdownMaxHeight="200"
                                                 ItemTemplate="{TemplateBinding ContentTemplate}"
                                                 EncodedItemTemplate="{TemplateBinding EncodedItemTemplate}"
                                                 FlyOutContentTemplate="{TemplateBinding FlyOutContentTemplate}"
                                                             FlyOutWidth="350"
                                                 >
                                    </local:EncodableInputBox>
                                    
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="MinWidth" Value="450" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:SingleConceptMatching">
                    <Border CornerRadius="3,3,3,3" 
                            BorderThickness="{TemplateBinding BorderThickness}" 
                            BorderBrush="{TemplateBinding BorderBrush}" 
                            Background="{TemplateBinding Background}" 
                            VerticalAlignment="{TemplateBinding VerticalAlignment}" 
                            HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                            Padding="{TemplateBinding Padding}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="300" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal" Grid.ColumnSpan="2" Margin="5"
                                        VerticalAlignment="Top" HorizontalAlignment="Left">

                                <TextBlock Text="{TemplateBinding SubsetPickerLabelText}" Margin="0,0,8,0"
                                           VerticalAlignment="Center" Style="{TemplateBinding LabelStyle}" />

                                <Grid x:Name="FilterComboBoxGrid"
                                      Grid.ColumnSpan="2"                                       
                                      Margin="5,5,5,5" 
                                      MinWidth="200">
                                    <ComboBox x:Name="FilterComboBox" 
                                              MinHeight="25"
                                      ItemsSource="{TemplateBinding SubsetPickerItemsSource}"
                                      ItemTemplate="{TemplateBinding SubsetPickerDataTemplate}"
                                          SelectedIndex="{TemplateBinding SubsetPickerSelectedIndex}"
                                          SelectedItem="{TemplateBinding SubsetPickerSelectedItem}"
                                          />
                                </Grid>
                            </StackPanel>

                            <TextBlock Grid.Row="1" Grid.ColumnSpan="2"
                                              Text="{TemplateBinding InputBoxLabelText}"
                                              Margin="5,5,5,0"
                                       Style="{TemplateBinding LabelStyle}" />




                            <local:EncodableInputBox x:Name="EncodableInputBox" Grid.Row="2" Margin="5,5,5,0"
                                                     ItemsSource="{TemplateBinding InputBoxItemsSource}"
                                                     ItemContainerStyle="{TemplateBinding InputBoxItemContainerStyle}"
                                                     ItemTemplate="{TemplateBinding InputBoxItemTemplate}"
                                                     EncodedItemTemplate="{TemplateBinding InputBoxEncodedItemTemplate}"
                                                     FlyOutContentTemplate="{TemplateBinding InputBoxFlyOutTemplate}"
                                                     SelectedItem="{TemplateBinding InputBoxSelectedItem}"
                                                     Text="{TemplateBinding InputBoxText}"
                                                     FlyOutWidth="{TemplateBinding InputBoxFlyOutWidth}"
                                                     Watermark="{TemplateBinding InputBoxWatermark}"
                                                     WatermarkTemplate="{TemplateBinding InputBoxWatermarkTemplate}"
                                                     IsSearchButtonVisible="{TemplateBinding InputBoxIsSearchButtonVisible}"
                                                     MaxLength="{TemplateBinding InputBoxMaxLength}"
                                                     Style="{TemplateBinding InputBoxStyle}"
                                                     SearchButtonToolTip="{TemplateBinding InputBoxSearchButtonToolTip}"
                                                     />

                            <local:DecoratorTextBox x:Name="DecoratorTextBox" Grid.Row="2" Grid.RowSpan="2" Grid.Column="1"
                                                    Margin="5,5,5,5"
                                                    MinHeight="70" 
                                                    MaxLength="{TemplateBinding AdditionalTextBoxMaxLength}"
                                                    Text="{TemplateBinding AdditionalTextBoxText}"
                                                    IsReadOnly="{TemplateBinding AdditionalTextBoxIsReadOnly}"
                                                    Watermark="{TemplateBinding AdditionalTextBoxWatermark}"
                                                    WatermarkTemplate="{TemplateBinding AdditionalTextBoxWatermarkTemplate}"
                                                    MatchingTermItemsSource="{TemplateBinding AdditionalTextBoxMatchingTermItemsSource}"
                                                    MatchingTermStartIndexMemberPath="{TemplateBinding AdditionalTextBoxMatchingTermStartIndexMemberPath}"
                                                    MatchingTermLengthMemberPath="{TemplateBinding AdditionalTextBoxMatchingTermLengthMemberPath}"
                                                    MatchingTermIsSelectedMemberPath="{TemplateBinding AdditionalTextBoxMatchingTermIsSelectedMemberPath}"
                                                    DecoratorItemContainerStyle="{TemplateBinding AdditionalTextBoxDecoratorItemContainerStyle}"
                                                    Style="{TemplateBinding AdditionalTextBoxStyle}"
                                                    IsEnabled="False"
                                                    />
                            
                            <local:MatchingTermItemsControl x:Name="MatchingTermItemsControl" IsTabStop="False"
                                                                Margin="5,0,0,5" Grid.Row="3" Grid.RowSpan="2" 
                                                                IsSelectedMemberPath="{TemplateBinding AdditionalTextBoxMatchingTermIsSelectedMemberPath}"
                                                                ItemsSource="{TemplateBinding AdditionalTextBoxDisplayedMatchingTerms}"
                                                                LengthMemberPath="{TemplateBinding AdditionalTextBoxMatchingTermLengthMemberPath}"
                                                                ItemTemplate="{TemplateBinding MatchingTermItemsControlItemTemplate}"
                                                                EncodedItemTemplate="{TemplateBinding MatchingTermItemsControlEncodedItemTemplate}"
                                                                ItemContainerStyle="{TemplateBinding MatchingTermItemsControlItemContainerStyle}"
                                                                SelectedItemMemberPath="{TemplateBinding MatchingTermSelectedItemMemberPath}"
                                                                SelectedItemTextMemberPath="{TemplateBinding MatchingTermSelectedItemTextMemberPath}"
                                                                AlternateItemsMemberPath="{TemplateBinding MatchingTermAlternateItemsMemberPath}"
                                                                FlyOutContentTemplate="{TemplateBinding MatchingTermFlyOutContentTemplate}"
                                                                />

                            <StackPanel Grid.Row="4" Grid.ColumnSpan="2" Margin="0,0,0,0" Orientation="Horizontal" VerticalAlignment="Bottom" HorizontalAlignment="Right">
                                <Button x:Name="SaveButton" BorderThickness="1,1,1,1" Content="Save" Margin="5,5,5,5" Width="60" IsEnabled="{TemplateBinding IsSaveButtonEnabled}"
                                        MinHeight="25" />
                                <Button x:Name="ClearButton" Content="Clear" Margin="5,5,5,5" Width="60"
                                        MinHeight="25" />
                            </StackPanel>

                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="Button" x:Key="ELEMENT_directionArrowStyle">
        <Setter Property="Canvas.ZIndex" Value="1000" />
        <Setter Property="Visibility"  Value="Collapsed" />
        <Setter Property="IsHitTestVisible" Value="True" />
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid>
                        <Rectangle Fill="Transparent" />
                        <Polygon Points="8,0, 16,6, 12,6, 12,12, 4,12, 4,6, 0,6" Fill="#BB0000" Stroke="#000000" Opacity="0.5" StrokeThickness="1" />
                        <ContentPresenter Margin="{TemplateBinding Padding}" HorizontalAlignment="Center" VerticalAlignment="Center" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                        <ToolTipService.ToolTip>
                            <ToolTip Template="{StaticResource ToolTipTemplate}">
                                <ToolTip.Content>
                                    <TextBlock FontWeight="Normal" HorizontalAlignment="Left" TextWrapping="Wrap" Text="Scroll to view more data"></TextBlock>
                                </ToolTip.Content>
                            </ToolTip>
                        </ToolTipService.ToolTip>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:PanelViewer">
        <Setter Property="Height" Value="200" />
        <Setter Property="Width" Value="500" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:PanelViewer">
                    <Border BorderThickness="1" BorderBrush="Gray" CornerRadius="4">
                        <Grid x:Name="ELEMENT_layoutRoot">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="21"/>
                            </Grid.RowDefinitions>

                            <Canvas x:Name="ELEMENT_dynamicMainLayerViewport" 
                                            Margin="2,2,2,0"
                                            Grid.Row="0" 
                                            Canvas.ZIndex="10">
                            </Canvas>

                            <ScrollBar x:Name="ELEMENT_scrollBar" 
                                               Margin="2,2,2,2" 
                                               Orientation="Horizontal" 
                                               Grid.Row="1"  
                                               VerticalAlignment="Bottom" 
                                               Maximum="49400" 
                                               SmallChange="1" 
                                               LargeChange="10">
                            </ScrollBar>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:TimeLineGraph">
        <Setter Property="NormalRangeDescription" Value="Adult normal range" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:TimeLineGraph">
                    <Grid>
                        <Border BorderThickness="1" BorderBrush="Gray" CornerRadius="4">                        
                            <Grid x:Name="ELEMENT_layoutRoot" Background="{TemplateBinding Background}">
                                <Grid.Resources>
                                    <DataTemplate x:Key="ELEMENT_dynamicMainLayerTemplate">
                                        <Grid x:Name="ELEMENT_dynamicMainLayer">
                                            <Canvas Background="White" Canvas.ZIndex="10" VerticalAlignment="Top" x:Name="ELEMENT_dynamicTopAxisLayerViewport" Height="30">
                                                <Canvas x:Name="ELEMENT_dynamicTopAxisLayer">

                                                </Canvas>
                                            </Canvas>
                                            <Canvas Canvas.ZIndex="5" x:Name="ELEMENT_dynamicPlotLayerViewport" Margin="0,30,0,0">
                                                <Canvas x:Name="ELEMENT_dynamicPlotLayer">
                                                </Canvas>
                                                <Canvas x:Name="ELEMENT_minimizedPlotLayer" Visibility="Collapsed" />
                                            </Canvas>                                            
                                        </Grid>
                                    </DataTemplate>
                                    <DataTemplate x:Key="Element_MinimizedViewLine">
                                        <Line X1="{Binding X1Pixel}" X2="{Binding X2Pixel}" Y1="{Binding Y1Pixel}" Y2="{Binding Y1Pixel}" Stroke="#4A7EBB" />
                                    </DataTemplate>
                                    <DataTemplate x:Key="ELEMENT_collisionTemplate">
                                        <Grid Canvas.ZIndex="6" Opacity="0.6" Width="23" Height="19"  local:GraphBase.XOffset="0" local:GraphBase.YOffset="-23">
                                            <Path Margin="0.4,0.4,0.2,0.2" Fill="#FFF3F500" Stretch="Fill" Stroke="#FF000000" Data="M0.75,14.125 C17.375,14.125 17.125,14.125 17.125,14.125 L9.1251093,0.125 z" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" StrokeThickness="1.2"/>
                                            <Path RenderTransformOrigin="0,0" Margin="10.25,6.125,9.75,2.75" Fill="#FF000000" Stretch="Fill" Data="M1.9921874,9.7406769 C2.2382813,9.7406769 2.4482422,9.8256378 2.6220703,9.9955597 C2.7958984,10.165482 2.8828125,10.371536 2.8828125,10.613724 C2.8828125,10.887161 2.7949219,11.102005 2.6191406,11.258255 C2.4433594,11.414505 2.2382813,11.49263 2.0039063,11.49263 C1.765625,11.49263 1.5576172,11.415482 1.3798828,11.261185 C1.2910156,11.184036 1.2243652,11.091507 1.1799316,10.983597 C1.135498,10.875687 1.1132813,10.752396 1.1132813,10.613724 C1.1132813,10.371536 1.1982422,10.165482 1.3681641,9.9955597 C1.5380859,9.8256378 1.7460938,9.7406769 1.9921874,9.7406769 z M2.0390625,2.6215363 C2.2070313,2.6215363 2.347168,2.650589 2.4594727,2.7086945 C2.5717773,2.7667999 2.65625,2.8539581 2.7128906,2.9701691 C2.7695313,3.08638 2.8120117,3.2282257 2.840332,3.3957062 C2.8686523,3.5631866 2.8828125,3.7563019 2.8828125,3.9750519 C2.8828125,4.2328644 2.8691406,4.4945831 2.8417969,4.7602081 L2.5898438,7.64888 C2.5625,7.99263 2.5039063,8.2563019 2.4140625,8.4398956 C2.3691406,8.5316925 2.3095703,8.6005402 2.2353516,8.6464386 C2.1611328,8.692337 2.0722656,8.7152863 1.96875,8.7152863 C1.8632813,8.7152863 1.7739258,8.6930695 1.7006836,8.6486359 C1.6274414,8.6042023 1.5703125,8.5375519 1.5292969,8.4486847 C1.4882813,8.3598175 1.453125,8.247757 1.4238281,8.1125031 C1.3945313,7.9772491 1.3710938,7.8188019 1.3535156,7.6371613 L1.1660156,4.8305206 C1.1484375,4.5570831 1.1352539,4.3222198 1.1264648,4.1259308 C1.1176758,3.9296417 1.1132813,3.7719269 1.1132813,3.6527863 C1.1132813,3.3285675 1.1982422,3.0756378 1.3681641,2.8939972 C1.453125,2.8031769 1.5515137,2.7350616 1.6633301,2.6896515 C1.7751465,2.6442413 1.9003906,2.6215363 2.0390625,2.6215363 z">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <ScaleTransform ScaleX="1" ScaleY="1"/>
                                                        <SkewTransform AngleX="0" AngleY="0"/>
                                                        <RotateTransform Angle="0"/>
                                                        <TranslateTransform X="0" Y="0"/>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                            <ToolTipService.ToolTip>
                                                <ToolTip Template="{StaticResource ToolTipTemplate}">
                                                    <ToolTip.Content>
                                                        <StackPanel Width="125" Margin="5,0,5,0">
                                                            <TextBlock FontWeight="Bold" HorizontalAlignment="Left" TextWrapping="Wrap" Text="Overcrowded data"></TextBlock>
                                                            <TextBlock HorizontalAlignment="Left" TextWrapping="Wrap"><Run Text="Adjust your timescale to see this data."/></TextBlock>
                                                        </StackPanel>
                                                    </ToolTip.Content>
                                                </ToolTip>
                                            </ToolTipService.ToolTip>
                                        </Grid>
                                    </DataTemplate>
                                    <DataTemplate x:Key="ELEMENT_dataMarkerTemplate">
                                        <Rectangle Canvas.ZIndex="10" Height="5" Width="5" Fill="Blue" Stroke="Black" StrokeThickness="3" local:GraphBase.XOffset="-2.5" local:GraphBase.YOffset="-2.5" />
                                    </DataTemplate>
                                    <DataTemplate x:Key="ELEMENT_PointTemplate">
                                        <local:GraphPoint Canvas.ZIndex="9999" Y1="{Binding Y1}" X1="{Binding DateTime}"/>
                                    </DataTemplate>
                                    <DataTemplate x:Key="ELEMENT_LabelTemplate">
                                        <Border Canvas.ZIndex="9999" RenderTransformOrigin="0, 1"
                                            BorderThickness="1"     
                                            Background="White"
                                            BorderBrush="DarkGray" Padding="0" 
                                            CornerRadius="2"
                                            local:GraphBase.XOffset="2" 
                                            local:GraphBase.YOffset="-15"
                                        >
                                         
                                            <StackPanel Margin="0,-1,0,-1"><TextBlock x:Name="ELEMENT_labelTextBlock"  HorizontalAlignment="Left" Margin="0,0,0,0" Text="{Binding Path=DataContext}" /></StackPanel>
                                         
                                        </Border>
                                    </DataTemplate>
                                    <ScaleTransform x:Key="ELEMENT_LabelTransform" ScaleX="1.4" ScaleY="1.4">
                                    </ScaleTransform>
                                    <DataTemplate x:Key="ELEMENT_XAxisLabelTemplate">
                                        <TextBlock FontSize="11" />
                                    </DataTemplate>
                                    <DataTemplate x:Key="ELEMENT_YAxisLabelTemplate">
                                        <TextBlock FontSize="11" />
                                    </DataTemplate>
                                    <local:TimeFrequency x:Key="DefaultVisibleWindow" Unit="Minute" Value="5" />
                                </Grid.Resources>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="20"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20" />
                                </Grid.ColumnDefinitions>
                                                              
                                <Grid Grid.Row="0" Grid.ColumnSpan="2" x:Name="ELEMENT_TitleArea">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="5*" />
                                        <ColumnDefinition Width="5*" />
                                        <ColumnDefinition Width="80" />
                                    </Grid.ColumnDefinitions>
                                    <Rectangle RadiusX="2" RadiusY="2" Grid.ColumnSpan="3">
                                    </Rectangle>
                                    <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="0" HorizontalAlignment="Left">
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontWeight="Bold" Text="{Binding Title}"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding Units}" ToolTipService.ToolTip="{Binding UnitsDescription}"></TextBlock>
                                    </StackPanel>
                                    <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="1" HorizontalAlignment="Right" Visibility="{Binding ShowNormalRange}">
                                        <TextBlock Margin="5,0,0,0" FontSize="12" Text="{TemplateBinding NormalRangeDescription}"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding NormalRangeMinimumValue}"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="-"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding NormalRangeMaximumValue}"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding Units}" ToolTipService.ToolTip="{Binding UnitsDescription}"></TextBlock>
                                    </StackPanel>
                                    <StackPanel Margin="0,2,1,2" VerticalAlignment="Center" Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <local:CuiToggleButton IsTabStop="False" Width="50" Margin="5,0,0,0" x:Name="ELEMENT_ScaleToFit" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <local:CuiToggleButton.Content>
                                                <Grid Background="Transparent" Width="50" Height="20" ToolTipService.ToolTip="Scale to fit all data">
                                                    <Polyline Points="25,0 25,5 28,3" Stroke="Black"/>
                                                    <Polyline Points="25,5 22,3" Stroke="Black"/>
                                                    <Polyline Points="2,12 12,2 35,10 45,3" Stroke="Blue" />
                                                    <Polyline Points="25,18 25,10 28,12" Stroke="Black"/>
                                                    <Polyline Points="25,10 22,12" Stroke="Black"/>
                                                </Grid>
                                            </local:CuiToggleButton.Content>
                                            <local:CuiToggleButton.PressedStateContent>
                                                <Grid Width="50" Height="20" Background="Orange" ToolTipService.ToolTip="Return to default scale">
                                                    <Polyline Points="25,7 25,0 28,3" Stroke="Black"/>
                                                    <Polyline Points="25,0 22,3" Stroke="Black"/>
                                                    <Polyline Points="2,12 12,2 35,10 45,3" Stroke="Blue" />
                                                    <Polyline Points="25,8 25,14 28,11" Stroke="Black"/>
                                                    <Polyline Points="25,14 22,11" Stroke="Black"/>
                                                </Grid>
                                            </local:CuiToggleButton.PressedStateContent>
                                        </local:CuiToggleButton>
                                        <local:CuiToggleButton IsTabStop="False" Width="20" x:Name="ELEMENT_MinimizeToTitle" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <local:CuiToggleButton.Content>
                                                <Grid Background="Transparent" ToolTipService.ToolTip="Minimize" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                    <Rectangle Margin="0,8,0,0" Height="1" Width="10" Stroke="#FF000000" StrokeThickness="2" />
                                                </Grid>
                                            </local:CuiToggleButton.Content>
                                            <local:CuiToggleButton.PressedStateContent>
                                                <Grid Background="Transparent" ToolTipService.ToolTip="Maximize" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                    <Rectangle Height="10" Width="10" Stroke="#FF000000" StrokeThickness="2" />
                                                </Grid>
                                            </local:CuiToggleButton.PressedStateContent>
                                        </local:CuiToggleButton>
                                    </StackPanel>
                                </Grid>

                                <Grid Grid.Row="1" Margin="5,0,30,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Border BorderBrush="Gray" BorderThickness="1,0,1,1" Grid.Column="0">
                                        <TextBlock Text="" x:Name="ELEMENT_XAxisTitleStartDate" FontSize="14" />
                                    </Border>
                                    <Border BorderBrush="Gray" BorderThickness="1,0,1,1" Grid.Column="2">
                                        <TextBlock Text="" x:Name="ELEMENT_XAxisTitleEndDate" HorizontalAlignment="Right" FontSize="14"/>
                                    </Border>
                                </Grid>

                                <Canvas Grid.Row="2" Canvas.ZIndex="10" Margin="5,0,30,5" x:Name="ELEMENT_dynamicMainLayerViewport">
                                    <Button x:Name="ELEMENT_directionArrowUp" Margin="0,30,0,0" Style="{StaticResource ELEMENT_directionArrowStyle}">
                                    </Button>
                                    <Button x:Name="ELEMENT_directionArrowDown" Margin="0,0,0,5" Style="{StaticResource ELEMENT_directionArrowStyle}">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="180"/>
                                        </Button.RenderTransform>
                                    </Button>
                                </Canvas>

                                <Canvas Grid.Row="2" Canvas.ZIndex="5" Margin="5,30,0,5" x:Name="ELEMENT_nonDynamicRightAxisViewPort" Background="White">
                                    <Canvas x:Name="ELEMENT_NonDynamicRightAxisLabels">
                                    </Canvas>
                                    <Canvas x:Name="ELEMENT_NonDynamicRightAxisLines">
                                    </Canvas>
                                </Canvas>

                                <ScrollBar Grid.Row="2" Margin="2,30,2,5" Orientation="Vertical" Grid.Column="1" Minimum="-155" Maximum="155" Value="0" SmallChange="5" LargeChange="10" x:Name="ELEMENT_scrollBarVertical"/>
                                <ScrollBar Orientation="Horizontal" Margin="2,2,2,2" Grid.Row="3" x:Name="ELEMENT_scrollBar"/>

                            </Grid>
                        </Border>
                        <Rectangle x:Name="FocusVisualElement" Opacity="0" IsHitTestVisible="False" StrokeThickness="1" Stroke="Black" StrokeDashArray="3 4" Margin="1, 1, 1, 1" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>        
    </Style>
    
    <Style TargetType="local:TimeIBarGraph">
        <Setter Property="NormalRangeDescription" Value="Adult normal range" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:TimeIBarGraph">
                    <Grid>
                        <Border BorderThickness="1" BorderBrush="Gray" CornerRadius="4">                        
                            <Grid x:Name="ELEMENT_layoutRoot" Background="{TemplateBinding Background}">
                                <Grid.Resources>
                                    <DataTemplate x:Key="ELEMENT_dynamicMainLayerTemplate">
                                        <Grid x:Name="ELEMENT_dynamicMainLayer">
                                            <Canvas Background="White" Margin="0,0,0,0" Canvas.ZIndex="10" VerticalAlignment="Top" x:Name="ELEMENT_dynamicTopAxisLayerViewport" Height="30">
                                                <Canvas x:Name="ELEMENT_dynamicTopAxisLayer">

                                                </Canvas>
                                            </Canvas>
                                            <Canvas Canvas.ZIndex="5" x:Name="ELEMENT_dynamicPlotLayerViewport" Margin="0,30,0,0">                                                
                                                <Canvas x:Name="ELEMENT_dynamicPlotLayer">
                                                </Canvas>
                                                <Canvas x:Name="ELEMENT_minimizedPlotLayer" Visibility="Collapsed" />
                                            </Canvas>                                           
                                        </Grid>
                                    </DataTemplate>
                                    <DataTemplate x:Key="Element_MinimizedViewLine">
                                        <Line X1="{Binding X1Pixel}" X2="{Binding X2Pixel}" Y1="{Binding Y1Pixel}" Y2="{Binding Y1Pixel}" Stroke="#4A7EBB" />
                                    </DataTemplate>
                                    <DataTemplate x:Key="ELEMENT_dataMarkerTemplate">
                                        <Grid Canvas.ZIndex="10" Height="9" Width="9" local:GraphBase.XOffset="-4.5" local:GraphBase.YOffset="-1.5" local:GraphBase.SnapToPixels="True">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="3"/>
                                                <RowDefinition Height="*"/>
                                                <RowDefinition Height="3"/>
                                            </Grid.RowDefinitions>
                                            <Rectangle Grid.Row="0" VerticalAlignment="Top" Height="3" Width="9" Fill="Black"/>
                                            <Rectangle Grid.Row="1" HorizontalAlignment="Center" Fill="Black" Width="1"/>
                                            <Rectangle Grid.Row="2" VerticalAlignment="Bottom" Height="3" Width="9" Fill="Black"/>
                                        </Grid>
                                    </DataTemplate>
                                    <DataTemplate x:Key="ELEMENT_PointTemplate">
                                        <local:GraphPoint Canvas.ZIndex="9999" Y1="{Binding Y1}" Y2="{Binding Y2}" X1="{Binding DateTime}"/>
                                    </DataTemplate>
                                    <DataTemplate x:Key="ELEMENT_LabelTemplate">
                                        <Border Canvas.ZIndex="9999" RenderTransformOrigin="0, 1"
                                            BorderThickness="1"     
                                            Background="White"
                                            BorderBrush="DarkGray" Padding="0" 
                                            CornerRadius="2"                                               
                                            local:GraphBase.XOffset="2" 
                                            local:GraphBase.YOffset="-15"
                                        >

                                            <StackPanel Margin="0,-1,0,-1"><TextBlock x:Name="ELEMENT_labelTextBlock"  HorizontalAlignment="Left" Margin="0,0,0,0" Text="{Binding Path=DataContext}" /></StackPanel>

                                        </Border>
                                    </DataTemplate>
                                    <ScaleTransform x:Key="ELEMENT_LabelTransform" ScaleX="1.4" ScaleY="1.4">
                                    </ScaleTransform>
                                    <DataTemplate x:Key="ELEMENT_XAxisLabelTemplate">
                                        <TextBlock FontSize="11" />
                                    </DataTemplate>
                                    <DataTemplate x:Key="ELEMENT_YAxisLabelTemplate">
                                        <TextBlock FontSize="11" />
                                    </DataTemplate>
                                    <local:TimeFrequency x:Key="DefaultVisibleWindow" Unit="Minute" Value="5" />
                                </Grid.Resources>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="25"/>
                                    <RowDefinition Height="30"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="20"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20" />
                                </Grid.ColumnDefinitions>
                                <Grid Grid.Row="0" Grid.ColumnSpan="2" x:Name="ELEMENT_TitleArea">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="5*" />
                                        <ColumnDefinition Width="5*" />
                                        <ColumnDefinition Width="80" />
                                    </Grid.ColumnDefinitions>
                                    <Rectangle RadiusX="2" RadiusY="2" Grid.ColumnSpan="3">
                                    </Rectangle>
                                    <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="0" HorizontalAlignment="Left">
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontWeight="Bold" Text="{Binding Title}"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding Units}" ToolTipService.ToolTip="{Binding UnitsDescription}"></TextBlock>
                                    </StackPanel>
                                    <StackPanel VerticalAlignment="Center" Orientation="Horizontal" Grid.Column="1" HorizontalAlignment="Right" Visibility="{Binding ShowNormalRange}">
                                        <TextBlock Margin="5,0,0,0" FontSize="12" Text="{TemplateBinding NormalRangeDescription}"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding NormalRangeMinimumValue}"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="-"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding NormalRangeMaximumValue}"></TextBlock>
                                        <TextBlock Margin="5,0,0,0" FontSize="12" FontStyle="Italic" Text="{Binding Units}" ToolTipService.ToolTip="{Binding UnitsDescription}"></TextBlock>
                                    </StackPanel>
                                    <StackPanel Margin="0,2,1,2" VerticalAlignment="Center" Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <local:CuiToggleButton IsTabStop="False" Width="50" Margin="5,0,0,0" x:Name="ELEMENT_ScaleToFit" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <local:CuiToggleButton.Content>
                                                <Grid Background="Transparent" Width="50" Height="20" ToolTipService.ToolTip="Scale to fit all data">
                                                    <Polyline Points="25,0 25,5 28,3" Stroke="Black"/>
                                                    <Polyline Points="25,5 22,3" Stroke="Black"/>
                                                    <Polyline Points="2,12 12,2 35,10 45,3" Stroke="Blue" />
                                                    <Polyline Points="25,18 25,10 28,12" Stroke="Black"/>
                                                    <Polyline Points="25,10 22,12" Stroke="Black"/>
                                                </Grid>
                                            </local:CuiToggleButton.Content>
                                            <local:CuiToggleButton.PressedStateContent>
                                                <Grid Width="50" Height="20" Background="Orange" ToolTipService.ToolTip="Return to default scale">
                                                    <Polyline Points="25,7 25,0 28,3" Stroke="Black"/>
                                                    <Polyline Points="25,0 22,3" Stroke="Black"/>
                                                    <Polyline Points="2,12 12,2 35,10 45,3" Stroke="Blue" />
                                                    <Polyline Points="25,8 25,14 28,11" Stroke="Black"/>
                                                    <Polyline Points="25,14 22,11" Stroke="Black"/>
                                                </Grid>
                                            </local:CuiToggleButton.PressedStateContent>
                                        </local:CuiToggleButton>
                                        <local:CuiToggleButton IsTabStop="False" Width="20" x:Name="ELEMENT_MinimizeToTitle" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                            <local:CuiToggleButton.Content>
                                                <Grid Background="Transparent" ToolTipService.ToolTip="Minimize" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                    <Rectangle Margin="0,8,0,0" Height="1" Width="10" Stroke="#FF000000" StrokeThickness="2" />
                                                </Grid>
                                            </local:CuiToggleButton.Content>
                                            <local:CuiToggleButton.PressedStateContent>
                                                <Grid Background="Transparent" ToolTipService.ToolTip="Maximize" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                    <Rectangle Height="10" Width="10" Stroke="#FF000000" StrokeThickness="2" />
                                                </Grid>
                                            </local:CuiToggleButton.PressedStateContent>
                                        </local:CuiToggleButton>
                                    </StackPanel>
                                </Grid>
                               
                                <Grid Grid.Row="1" Margin="5,0,30,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Border BorderBrush="Gray" BorderThickness="1,0,1,1" Grid.Column="0">
                                        <TextBlock Text="" x:Name="ELEMENT_XAxisTitleStartDate" FontSize="14" />
                                    </Border>
                                    <Border BorderBrush="Gray" BorderThickness="1,0,1,1" Grid.Column="2">
                                        <TextBlock Text="" x:Name="ELEMENT_XAxisTitleEndDate" HorizontalAlignment="Right" FontSize="14"/>
                                    </Border>
                                </Grid>
                                
                                <Canvas Grid.Row="2" Canvas.ZIndex="10" Margin="5,0,30,5" x:Name="ELEMENT_dynamicMainLayerViewport">
                                    <Button x:Name="ELEMENT_directionArrowUp" Margin="0,30,0,0" Style="{StaticResource ELEMENT_directionArrowStyle}">
                                    </Button>
                                    <Button x:Name="ELEMENT_directionArrowDown" Style="{StaticResource ELEMENT_directionArrowStyle}">
                                        <Button.RenderTransform>
                                            <RotateTransform Angle="180"/>
                                        </Button.RenderTransform>
                                    </Button>
                                </Canvas>

                                <Canvas Grid.Row="2" Canvas.ZIndex="5" Margin="5,30,0,5" x:Name="ELEMENT_nonDynamicRightAxisViewPort" Background="White">
                                    <Canvas x:Name="ELEMENT_NonDynamicRightAxisLabels">
                                    </Canvas>
                                    <Canvas x:Name="ELEMENT_NonDynamicRightAxisLines">
                                    </Canvas>
                                </Canvas>

                                <ScrollBar Grid.Row="2" Margin="2,30,2,5" Orientation="Vertical" Grid.Column="1" Minimum="-155" Maximum="155" Value="0" SmallChange="5" LargeChange="10" x:Name="ELEMENT_scrollBarVertical"/>
                                <ScrollBar Orientation="Horizontal" Margin="2,2,2,2" Grid.Row="3" x:Name="ELEMENT_scrollBar"/>

                            </Grid>
                        </Border>
                        <Rectangle x:Name="FocusVisualElement" Opacity="0" IsHitTestVisible="False" StrokeThickness="1" Stroke="Black" StrokeDashArray="3 4" Margin="1, 1, 1, 1" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:VisualFocusLine">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Canvas x:Name="ELEMENT_VisualFocusLineCanvas" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Canvas.ZIndex="10">
                        <Border x:Name="ELEMENT_TopPlaceHolder" Canvas.ZIndex="1" Background="White" BorderBrush="Black" BorderThickness="1">
                            <TextBlock x:Name="ELEMENT_TopDateTimeTextBlock"  />
                        </Border>
                        
                        <Rectangle x:Name="FocusVisualElement" Margin="-4,0,0,0" Width="8" Fill="#FF448DCA" Opacity="0.5" Visibility="Collapsed" />
                        <Line x:Name="ELEMENT_VisualFocusLine" Margin="0,0,0,0" Stroke="Red" StrokeThickness="3"/>

                        <Border x:Name="ELEMENT_BottomPlaceHolder" Canvas.ZIndex="2" Background="White" BorderBrush="Black" BorderThickness="1">
                            <TextBlock x:Name="ELEMENT_BottomDateTimeTextBlock" />
                        </Border>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <Style TargetType="local:GraphHost">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Grid>
                        <Border Margin="2,2,2,2"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="2">
                            <Grid x:Name="ELEMENT_LayoutRoot" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="5">
                                <Grid.Resources>
                                    <local:TimeFrequencyBindingHelper x:Key="timeFrequency" />
                                    <local:TimeFrequency x:Key="DefaultVisibleWindow" Unit="Minute" Value="5" />

                                    <Style TargetType="local:TimeLineGraph" x:Key="TopAxisStyle">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <Border>
                                                        <Grid x:Name="ELEMENT_layoutRoot" Background="{TemplateBinding Background}">
                                                            <Grid.Resources>
                                                                <DataTemplate x:Key="ELEMENT_dynamicMainLayerTemplate">
                                                                    <Grid x:Name="ELEMENT_dynamicMainLayer">
                                                                        <Canvas Background="Transparent" Canvas.ZIndex="10" VerticalAlignment="Top" x:Name="ELEMENT_dynamicTopAxisLayerViewport" Height="30">
                                                                            <Canvas x:Name="ELEMENT_dynamicTopAxisLayer" >

                                                                            </Canvas>
                                                                        </Canvas>
                                                                        <Canvas Canvas.ZIndex="5" x:Name="ELEMENT_dynamicPlotLayerViewport">
                                                                            <Canvas x:Name="ELEMENT_dynamicPlotLayer">
                                                                            </Canvas>
                                                                        </Canvas>                                                                        
                                                                    </Grid>
                                                                </DataTemplate>
                                                                <DataTemplate x:Key="ELEMENT_dataMarkerTemplate">
                                                                    <Rectangle Canvas.ZIndex="10" Height="5" Width="5" Fill="Blue" Stroke="Black" StrokeThickness="3" local:GraphBase.XOffset="-2.5" local:GraphBase.YOffset="-2.5" />
                                                                </DataTemplate>
                                                                <DataTemplate x:Key="ELEMENT_PointTemplate">
                                                                    <local:GraphPoint Canvas.ZIndex="9999" Y1="{Binding Y1}" Y2="{Binding Y2}" X1="{Binding DateTime}"/>
                                                                </DataTemplate>
                                                                <DataTemplate x:Key="ELEMENT_XAxisLabelTemplate">
                                                                    <TextBlock FontSize="11" />
                                                                </DataTemplate>
                                                                <DataTemplate x:Key="ELEMENT_YAxisLabelTemplate">
                                                                    <TextBlock FontSize="11" />
                                                                </DataTemplate>
                                                                <local:TimeFrequency x:Key="DefaultVisibleWindow" Unit="Minute" Value="5" />
                                                            </Grid.Resources>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="0"/>
                                                                <RowDefinition Height="20"/>
                                                                <RowDefinition Height="*"/>
                                                                <RowDefinition Height="0"/>
                                                            </Grid.RowDefinitions>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="20" />
                                                            </Grid.ColumnDefinitions>

                                                            <Grid Grid.Row="1" Margin="5,0,30,0">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto" />
                                                                    <ColumnDefinition Width="*" />
                                                                    <ColumnDefinition Width="Auto" />
                                                                </Grid.ColumnDefinitions>
                                                                <Border BorderBrush="Gray" BorderThickness="1,0,1,1" Grid.Column="0">
                                                                    <TextBlock Text="" x:Name="ELEMENT_XAxisTitleStartDate" FontSize="14" />
                                                                </Border>
                                                                <Border BorderBrush="Gray" BorderThickness="1,0,1,1" Grid.Column="2">
                                                                    <TextBlock Text="" x:Name="ELEMENT_XAxisTitleEndDate" HorizontalAlignment="Right" FontSize="14"/>
                                                                </Border>
                                                            </Grid>

                                                            <Canvas Grid.Row="2" Canvas.ZIndex="10" Margin="5,0,30,0" x:Name="ELEMENT_dynamicMainLayerViewport"/>
                                                            <Canvas Visibility="Collapsed" Grid.Row="2" Canvas.ZIndex="5" Margin="5,0,0,0" x:Name="ELEMENT_nonDynamicRightAxisViewPort">
                                                                <Canvas x:Name="ELEMENT_NonDynamicRightAxisLabels">
                                                                </Canvas>
                                                                <Canvas x:Name="ELEMENT_NonDynamicRightAxisLines">
                                                                </Canvas>
                                                            </Canvas>

                                                            <ScrollBar  Visibility="Collapsed" Grid.Row="2" Margin="2,2,2,2" Orientation="Vertical" Grid.Column="1" Minimum="-155" Maximum="155" Value="0" SmallChange="5" LargeChange="10" x:Name="ELEMENT_scrollBarVertical"/>
                                                            <ScrollBar  Visibility="Visible" Margin="2,2,2,2" Grid.Row="3" x:Name="ELEMENT_scrollBar"/>

                                                        </Grid>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>

                                    <Style TargetType="local:TimeLineGraph" x:Key="BottomAxisStyle">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <Border>
                                                        <Grid x:Name="ELEMENT_layoutRoot" Background="{TemplateBinding Background}">
                                                            <Grid.Resources>
                                                                <DataTemplate x:Key="ELEMENT_dynamicMainLayerTemplate">
                                                                    <Grid x:Name="ELEMENT_dynamicMainLayer">
                                                                        <Canvas Background="Transparent" Canvas.ZIndex="10" VerticalAlignment="Top" x:Name="ELEMENT_dynamicTopAxisLayerViewport" Height="30">
                                                                            <Canvas x:Name="ELEMENT_dynamicTopAxisLayer" >

                                                                            </Canvas>
                                                                        </Canvas>
                                                                        <Canvas Canvas.ZIndex="5" x:Name="ELEMENT_dynamicPlotLayerViewport">
                                                                            <Canvas x:Name="ELEMENT_dynamicPlotLayer">
                                                                            </Canvas>
                                                                        </Canvas>                                                                        
                                                                    </Grid>
                                                                </DataTemplate>
                                                                <DataTemplate x:Key="ELEMENT_dataMarkerTemplate">
                                                                    <Rectangle Canvas.ZIndex="10" Height="5" Width="5" Fill="Blue" Stroke="Black" StrokeThickness="3" local:GraphBase.XOffset="-2.5" local:GraphBase.YOffset="-2.5" />
                                                                </DataTemplate>
                                                                <DataTemplate x:Key="ELEMENT_PointTemplate">
                                                                    <local:GraphPoint Canvas.ZIndex="9999" Y1="{Binding Y1}" Y2="{Binding Y2}" X1="{Binding DateTime}"/>
                                                                </DataTemplate>
                                                                <DataTemplate x:Key="ELEMENT_XAxisLabelTemplate">
                                                                    <TextBlock FontSize="11" />
                                                                </DataTemplate>
                                                                <DataTemplate x:Key="ELEMENT_YAxisLabelTemplate">
                                                                    <TextBlock FontSize="11" />
                                                                </DataTemplate>
                                                                <local:TimeFrequency x:Key="DefaultVisibleWindow" Unit="Minute" Value="5" />
                                                            </Grid.Resources>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="0"/>
                                                                <RowDefinition Height="*"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="0"/>
                                                            </Grid.RowDefinitions>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="20" />
                                                            </Grid.ColumnDefinitions>

                                                            <Grid Grid.Row="2" Margin="5,0,30,0">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto" />
                                                                    <ColumnDefinition Width="*" />
                                                                    <ColumnDefinition Width="Auto" />
                                                                </Grid.ColumnDefinitions>
                                                                <Border BorderBrush="Gray" BorderThickness="1,1,1,0" Grid.Column="0">
                                                                    <TextBlock Text="" x:Name="ELEMENT_XAxisTitleStartDate" FontSize="14" />
                                                                </Border>
                                                                <Border BorderBrush="Gray" BorderThickness="1,1,1,0" Grid.Column="2">
                                                                    <TextBlock Text="" x:Name="ELEMENT_XAxisTitleEndDate" HorizontalAlignment="Right" FontSize="14"/>
                                                                </Border>
                                                            </Grid>

                                                            <Canvas Grid.Row="1" Canvas.ZIndex="10" Margin="5,0,30,0" x:Name="ELEMENT_dynamicMainLayerViewport"/>
                                                            <Canvas Visibility="Collapsed" Grid.Row="1" Canvas.ZIndex="5" Margin="5,0,0,0" x:Name="ELEMENT_nonDynamicRightAxisViewPort">
                                                                <Canvas x:Name="ELEMENT_NonDynamicRightAxisLabels">
                                                                </Canvas>
                                                                <Canvas x:Name="ELEMENT_NonDynamicRightAxisLines">
                                                                </Canvas>
                                                            </Canvas>

                                                            <ScrollBar  Visibility="Collapsed" Grid.Row="1" Margin="2,2,2,2" Orientation="Vertical" Grid.Column="1" Minimum="-155" Maximum="155" Value="0" SmallChange="5" LargeChange="10" x:Name="ELEMENT_scrollBarVertical"/>
                                                            <ScrollBar  Visibility="Visible" Margin="2,2,2,2" Grid.Row="3" x:Name="ELEMENT_scrollBar"/>

                                                        </Grid>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>

                                    <DataTemplate x:Key="DataSelectorItemTemplate">
                                        <local:DataSelectorItem HorizontalAlignment="Stretch" IsTabStop="False" FontSize="12" Background="{Binding Background}" HoverBackground="{Binding HoverBackground}">
                                            <local:DataSelectorItem.Content>
                                                <Grid>
                                                    <Border Margin="0,1,0,1" Width="350" Background="White" HorizontalAlignment="Stretch">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="20" />
                                                                <ColumnDefinition Width="12" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>

                                                            <CheckBox VerticalAlignment="Center" Grid.Column="0" Margin="2,0,0,0" IsThreeState="False" IsChecked="{Binding Show, Mode=TwoWay}" />
                                                            <ContentControl IsTabStop="False" Grid.Column="1" Margin="2,0,0,0" VerticalAlignment="Center" ContentTemplate="{Binding DataMarker}" />

                                                            <Grid x:Name="LayoutRoot" Grid.Column="2" MinHeight="17" Margin="5,0,0,0" HorizontalAlignment="Stretch" Background="{Binding Background}">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="5*"/>
                                                                    <ColumnDefinition Width="2*"/>
                                                                    <ColumnDefinition Width="5*"/>
                                                                </Grid.ColumnDefinitions>
                                                                <TextBlock Grid.Column="0" Margin="5,0,0,0" Text="{Binding Title}" VerticalAlignment="Center" FontWeight="Normal"/>
                                                                <Border Grid.Column="1" Width="50" Background="White" Margin="1" VerticalAlignment="Stretch" Visibility="{Binding VisualFocusLineVisibility}">
                                                                    <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Text="{Binding VisualFocusLineSelectedObject}"/>
                                                                </Border>
                                                                <TextBlock VerticalAlignment="Center" Grid.Column="2" Margin="5,0,5,0" Text="{Binding Units}" FontStyle="Italic" ToolTipService.ToolTip="{Binding UnitsDescription}" Width="Auto"/>
                                                            </Grid>
                                                        </Grid>
                                                    </Border>
                                                    <Rectangle x:Name="FocusVisualElement" Opacity="0" IsHitTestVisible="False" Width="350" StrokeThickness="1" Stroke="Black" StrokeDashArray="2 3" Margin="0, 0, -1, 0"/>
                                                </Grid>
                                            </local:DataSelectorItem.Content>
                                        </local:DataSelectorItem>
                                    </DataTemplate>
                                    <DataTemplate x:Key="Popup">
                                        <Popup>
                                            <Popup.Child>
                                                <Border Margin="0,1,0,1" Width="250" Background="White" HorizontalAlignment="Stretch">
                                                    <Grid HorizontalAlignment="Stretch" Background="{Binding Background}">
                                                        <TextBlock Grid.Column="0" Text="{Binding Title}" FontWeight="Normal" />
                                                    </Grid>
                                                </Border>
                                            </Popup.Child>
                                        </Popup>
                                    </DataTemplate>
                                </Grid.Resources>

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Graph Title Area -->
                                <Grid Margin="0,0,0,0" x:Name="ELEMENT_TitleFormatTimeGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="0.5*"/>
                                        <ColumnDefinition Width="0.5*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="36" />
                                    </Grid.RowDefinitions>

                                    <!-- Data Selector -->
                                    <Grid Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" HorizontalAlignment="Left" VerticalAlignment="Bottom" x:Name="ELEMENT_DataSelectorGrid" Margin="5,5,5,5">
                                        <local:DataSelector x:Name="ELEMENT_DataSelectorControl" IsTabStop="False" ItemTemplate="{StaticResource DataSelectorItemTemplate}" PopupTemplate="{StaticResource Popup}">
                                            <local:DataSelector.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel x:Name="DataSelectorItemsPanel" />
                                                </ItemsPanelTemplate>
                                            </local:DataSelector.ItemsPanel>
                                        </local:DataSelector>
                                    </Grid>

                                    <!-- Buttons and Timeselector -->
                                    <Grid HorizontalAlignment="Right" VerticalAlignment="Bottom" Grid.Column="2" Grid.Row="1" x:Name="ELEMENT_FormatGrid">
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="2">
                                            
                                            <StackPanel.Resources>
                                                <local:TimeFrequencyCollection x:Key="tfc">
                                                    <local:TimeFrequency Unit="Minute" Value="5"/>
                                                    <local:TimeFrequency Unit="Minute" Value="15"/>
                                                    <local:TimeFrequency Unit="Hour" Value="1"/>
                                                    <local:TimeFrequency Unit="Hour" Value="2"/>
                                                    <local:TimeFrequency Unit="Hour" Value="4"/>
                                                    <local:TimeFrequency Unit="Hour" Value="6"/>
                                                    <local:TimeFrequency Unit="Hour" Value="12"/>
                                                    <local:TimeFrequency Unit="Hour" Value="24"/>
                                                    <local:TimeFrequency Unit="Hour" Value="48"/>
                                                    <local:TimeFrequency Unit="Day" Value="5"/>
                                                    <local:TimeFrequency Unit="Day" Value="10"/>
                                                    <local:TimeFrequency Unit="Day" Value="15"/>
                                                    <local:TimeFrequency Unit="Day" Value="20"/>
                                                    <local:TimeFrequency Unit="Month" Value="1"/>
                                                    <local:TimeFrequency Unit="Month" Value="3"/>                                                    
                                                    <local:TimeFrequency Unit="Month" Value="6"/>
                                                    <local:TimeFrequency Unit="Month" Value="9"/>
                                                    <local:TimeFrequency Unit="Month" Value="12"/>
                                                    <local:TimeFrequency Unit="Month" Value="18"/>                                                    
                                                    <local:TimeFrequency Unit="Year" Value="2"/>
                                                    <local:TimeFrequency Unit="Year" Value="5"/>
                                                    <local:TimeFrequency Unit="Year" Value="10"/>
                                                    <local:TimeFrequency Unit="Year" Value="20"/>
                                                    <local:TimeFrequency Unit="Year" Value="100"/>
                                                </local:TimeFrequencyCollection>
                                            </StackPanel.Resources>
                                            <Button x:Name="ELEMENT_Reset" HorizontalAlignment="Right" VerticalAlignment="Stretch" Width="30" Height="30" ToolTipService.ToolTip="Reset all graphs to default view">
                                                <Button.Content>
                                                    <Grid>
                                                        <Ellipse Height="20" Width="20" Stroke="#FF000000" StrokeThickness="2" />
                                                        <Ellipse Margin="2" Height="10" Width="10" Fill="#FFAC5700" />
                                                    </Grid>
                                                </Button.Content>
                                            </Button>

                                            <local:CuiToggleButton x:Name="ELEMENT_ShowVFL" HorizontalAlignment="Center" VerticalAlignment="Center" Width="30" Height="30">
                                                <local:CuiToggleButton.Content>
                                                    <Grid Background="Transparent" ToolTipService.ToolTip="Activate the Visual Focus Line">
                                                        <Ellipse Height="16" Width="16" Fill="#FFFFFFFF" Stroke="#FF000000"/>
                                                        <Path Margin="0,0,0,0" Stretch="Uniform" Stroke="#FF000000" Data="M15,2 L15,28"/>
                                                        <Path Margin="0,0,0,0" Stretch="Uniform" Stroke="#FF000000" Data="M2,15 L28,15"/>
                                                    </Grid>
                                                </local:CuiToggleButton.Content>
                                                <local:CuiToggleButton.PressedStateContent>                                                    
                                                    <Grid Background="Transparent" ToolTipService.ToolTip="Deactivate the Visual Focus Line">
                                                        <Rectangle Margin="-2,-2,-2,-2" RadiusX="2" RadiusY="2" StrokeThickness="1">
                                                            <Rectangle.Stroke>
                                                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                    <GradientStop Color="#FFD3DBE2" Offset="1"/>                                                                    
                                                                    <GradientStop Color="#FF4787BF" Offset="0"/>
                                                                </LinearGradientBrush>
                                                            </Rectangle.Stroke>
                                                            <Rectangle.Fill>                                                            
                                                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                        <GradientStop Color="#FF7BAED9" Offset="0"/>
                                                                        <GradientStop Color="#FFE0ECF6" Offset="1"/>
                                                                    </LinearGradientBrush>                                                            
                                                            </Rectangle.Fill>
                                                        </Rectangle>
                                                        <Ellipse Height="16" Width="16" Fill="#FFFFFFFF" Stroke="#FF000000"/>
                                                        <Path Margin="0,0,0,0" Stretch="Uniform" Stroke="#FF000000" Data="M15,2 L15,28"/>
                                                        <Path Margin="0,0,0,0" Stretch="Uniform" Stroke="#FF000000" Data="M2,15 L28,15"/>
                                                    </Grid>
                                                </local:CuiToggleButton.PressedStateContent>
                                            </local:CuiToggleButton>

                                            <local:CuiToggleButton x:Name="ELEMENT_ShowDataPointLabels" 
                                                VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch" 
                                                                   HorizontalAlignment="Center" VerticalAlignment="Center" Width="30" Height="30">
                                                <local:CuiToggleButton.Content>
                                                    <Grid Background="Transparent" ToolTipService.ToolTip="Show data values">
                                                        <TextBlock HorizontalAlignment="Center"  
                                                                    VerticalAlignment="Center" Text="88" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                </local:CuiToggleButton.Content>
                                                <local:CuiToggleButton.PressedStateContent>
                                                    <Grid Background="Transparent" ToolTipService.ToolTip="Hide data values">                                                                                                           
                                                        <Rectangle Margin="-2,-2,-2,-2" RadiusX="2" RadiusY="2" StrokeThickness="1">
                                                            <Rectangle.Stroke>
                                                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                    <GradientStop Color="#FFD3DBE2" Offset="1"/>
                                                                    <GradientStop Color="#FF4787BF" Offset="0"/>
                                                                </LinearGradientBrush>
                                                            </Rectangle.Stroke>
                                                            <Rectangle.Fill>
                                                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                    <GradientStop Color="#FF7BAED9" Offset="0"/>
                                                                    <GradientStop Color="#FFE0ECF6" Offset="1"/>
                                                                </LinearGradientBrush>
                                                            </Rectangle.Fill>
                                                        </Rectangle>
                                                        <TextBlock  HorizontalAlignment="Center"  
                                                                    VerticalAlignment="Center" 
                                                                    Text="88" 
                                                                    FontSize="12" 
                                                                    FontWeight="Bold"/>                                                                                                                  
                                                    </Grid>
                                                </local:CuiToggleButton.PressedStateContent>
                                                </local:CuiToggleButton>
                                                <local:CuiToggleButton x:Name="ELEMENT_ShowInterpolationLines" IsChecked="True" 
                                                                       VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch" 
                                                                       HorizontalAlignment="Center" VerticalAlignment="Center" Width="30" Height="30">
                                                    <local:CuiToggleButton.Content>
                                                        <Grid Background="Transparent" ToolTipService.ToolTip="Show graph lines">
                                                        <Rectangle Margin="2,15,0,0" Width="4" Height="4" HorizontalAlignment="Left" VerticalAlignment="Top" Fill="#FF000000" Stretch="Fill" Stroke="#FF000000" />
                                                        <Rectangle Margin="10,2,0,0" Width="4" Height="4" HorizontalAlignment="Left" VerticalAlignment="Top" Fill="#FF000000" Stretch="Fill" Stroke="#FF000000" />
                                                        <Rectangle Margin="18,10,0,0" Width="4" Height="4" HorizontalAlignment="Left" VerticalAlignment="Top" Fill="#FF000000" Stretch="Fill" Stroke="#FF000000" />
                                                        <Line X1="6" X2="10" Y1="15" Y2="6" Stroke="#FF000000" StrokeThickness="1" />
                                                        <Line X1="14" X2="18" Y1="6" Y2="10" Stroke="#FF000000" StrokeThickness="1" />
                                                        </Grid>
                                                    </local:CuiToggleButton.Content>
                                                    <local:CuiToggleButton.PressedStateContent>
                                                        <Grid Background="Transparent" ToolTipService.ToolTip="Hide graph lines">
                                                            <Rectangle Margin="-2,-2,-2,-2" RadiusX="2" RadiusY="2" StrokeThickness="1">
                                                                <Rectangle.Stroke>
                                                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                        <GradientStop Color="#FFD3DBE2" Offset="1"/>
                                                                        <GradientStop Color="#FF4787BF" Offset="0"/>
                                                                    </LinearGradientBrush>
                                                                </Rectangle.Stroke>
                                                                <Rectangle.Fill>
                                                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                        <GradientStop Color="#FF7BAED9" Offset="0"/>
                                                                        <GradientStop Color="#FFE0ECF6" Offset="1"/>
                                                                    </LinearGradientBrush>
                                                                </Rectangle.Fill>
                                                            </Rectangle>

                                                            <Rectangle Margin="2,15,0,0" Width="4" Height="4" HorizontalAlignment="Left" VerticalAlignment="Top" Fill="#FF000000" Stretch="Fill" Stroke="#FF000000" />
                                                            <Rectangle Margin="10,2,0,0" Width="4" Height="4" HorizontalAlignment="Left" VerticalAlignment="Top" Fill="#FF000000" Stretch="Fill" Stroke="#FF000000" />
                                                            <Rectangle Margin="18,10,0,0" Width="4" Height="4" HorizontalAlignment="Left" VerticalAlignment="Top" Fill="#FF000000" Stretch="Fill" Stroke="#FF000000" />
                                                            <Line X1="6" X2="10" Y1="15" Y2="6" Stroke="#FF000000" StrokeThickness="1" />
                                                            <Line X1="14" X2="18" Y1="6" Y2="10" Stroke="#FF000000" StrokeThickness="1" />                                                       
                                                        </Grid>
                                                    </local:CuiToggleButton.PressedStateContent>
                                                    </local:CuiToggleButton>
                                                    <local:CuiToggleButton x:Name="ELEMENT_ShowGridLines" IsChecked="True" 
                                                                           VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch" 
                                                                           HorizontalAlignment="Center" VerticalAlignment="Center" Width="30" Height="30">
                                                        <local:CuiToggleButton.Content>
                                                            <Grid Background="Transparent" ToolTipService.ToolTip="Turn grid lines on">
                                                                <Path Margin="0,0,0,0" Stretch="Uniform" Stroke="#FF000000" Data="M15,2 L15,28"/>
                                                                <Path Margin="2,6,2,10" Stretch="Uniform" Stroke="#FF000000" Data="M2,10 L28,10"/>
                                                                <Path Margin="2,12,2,4" Stretch="Uniform" Stroke="#FF000000" Data="M2,15 L28,15"/>
                                                            </Grid>
                                                        </local:CuiToggleButton.Content>
                                                        <local:CuiToggleButton.PressedStateContent>
                                                            <Grid Background="Transparent" ToolTipService.ToolTip="Turn grid lines off">
                                                                <Rectangle Margin="-2,-2,-2,-2" RadiusX="2" RadiusY="2" StrokeThickness="1">
                                                                    <Rectangle.Stroke>
                                                                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                            <GradientStop Color="#FFD3DBE2" Offset="1"/>
                                                                            <GradientStop Color="#FF4787BF" Offset="0"/>
                                                                        </LinearGradientBrush>
                                                                    </Rectangle.Stroke>
                                                                    <Rectangle.Fill>
                                                                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                                            <GradientStop Color="#FF7BAED9" Offset="0"/>
                                                                            <GradientStop Color="#FFE0ECF6" Offset="1"/>
                                                                        </LinearGradientBrush>
                                                                    </Rectangle.Fill>
                                                                </Rectangle>
                                                            
                                                                <Path Margin="0,0,0,0" Stretch="Uniform" Stroke="#FF000000" Data="M15,2 L15,28"/>
                                                                <Path Margin="2,6,2,10" Stretch="Uniform" Stroke="#FF000000" Data="M2,10 L28,10"/>
                                                                <Path Margin="2,12,2,4" Stretch="Uniform" Stroke="#FF000000" Data="M2,15 L28,15"/>
                                                            
                                                            </Grid>
                                                        </local:CuiToggleButton.PressedStateContent>
                                                        </local:CuiToggleButton>

                                                        <TextBlock Text="Period" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="5,0,0,0" FontSize="11"/>
                                            <ComboBox VerticalAlignment="Center" Margin="5,0,5,0" Width="120" Height="25" FontSize="12"
                                              x:Name="ELEMENT_TimeSelector" VerticalContentAlignment="Center" HorizontalContentAlignment="Left" 
                                              ItemsSource="{Binding Source={StaticResource tfc}}"                                               
                                              SelectedItem="{Binding TimeFrequency, Source={StaticResource timeFrequency}, Mode=TwoWay}">
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>                                                        
                                                        <TextBlock Text="{Binding Description}" />
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                        </StackPanel>
                                    </Grid>
                                </Grid>
                            
                                <!-- Graph Area -->
                                <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="2" Grid.Row="1">
                                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="1" x:Name="ELEMENT_GraphArea" Background="{TemplateBinding Background}">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="50"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="50"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <!-- Visual Focus Line -->
                                        <local:VisualFocusLine x:Name="ELEMENT_VisualFocusLine" Visibility="Collapsed" Grid.Row="0" Grid.RowSpan="4" Canvas.ZIndex="99" />

                                        <!-- Top Axis>-->
                                        <Border Grid.Row="0" Padding="4,0,0,0">
                                            <Grid HorizontalAlignment="Left" x:Name="ELEMENT_TopAxisContainer">
                                                <local:TimeLineGraph x:Name="ELEMENT_TopAxis" Margin="1,0,1,0"
                                                     VisibleWindow="{Binding TimeFrequency, Source={StaticResource timeFrequency}, Mode=TwoWay}"
                                                     PlotData="False" IsTabStop="False" />
                                            </Grid>
                                        </Border>

                                        <!-- Graphs Collection -->
                                        <ScrollViewer Grid.Row="1" IsTabStop="True" x:Name="ELEMENT_ScrollViewer" Padding="4,0,4,0">
                                            <StackPanel Orientation="Vertical" x:Name="ELEMENT_RootPanel"/>
                                        </ScrollViewer>
                                        
                                        <!-- Bottom Axis -->
                                        <Border Grid.Row="2" Padding="4,0,0,0">
                                            <Grid HorizontalAlignment="Left" x:Name="ELEMENT_BottomAxisContainer">
                                                <local:TimeLineGraph x:Name="ELEMENT_BottomAxis" Margin="1,0,1,0"
                                                    VisibleWindow="{Binding TimeFrequency, Source={StaticResource timeFrequency}, Mode=TwoWay}"                                                
                                                    PlotData="False" PlotTicksBeforeLabels="True" Height="50" IsTabStop="False" />
                                            </Grid>
                                        </Border>
                                        
                                        <!-- Horizontal Scrollbar -->
                                        <ScrollBar Orientation="Horizontal" IsTabStop="True"
                                                   Grid.Row="3" 
                                                   Grid.Column="0" 
                                                   x:Name="ELEMENT_ScrollBar"
                                                   VerticalAlignment="Bottom" 
                                                   Maximum="10000" 
                                                   SmallChange="1" 
                                                   LargeChange="10" />


                                        <!-- The Visual Focus Indicator for the Graphs -->
                                        <Rectangle Grid.Row="1" x:Name="FocusVisualElement" Opacity="0" IsHitTestVisible="False" StrokeThickness="1" Stroke="Black" StrokeDashArray="3 4" />

                                        <!-- The Visual Focus Indicator for the horizontal scrollbar -->
                                        <Rectangle Grid.Row="3" x:Name="ScrollBarFocusVisualElement" Opacity="0" IsHitTestVisible="False" StrokeThickness="1" Stroke="Black" StrokeDashArray="2 3" />

                                    </Grid>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <!-- Begin Label Style -->
    <Style TargetType="local:BaseLabel">
        <Setter Property="BorderBrush" Value="#8C8C8C" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:BaseLabel">
                    <Grid 
                        Background="{TemplateBinding Background}"
                        VerticalAlignment="{TemplateBinding VerticalAlignment}"
                        HorizontalAlignment="{TemplateBinding HorizontalAlignment}"
                        >
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="ControlStates">
                                <VisualState x:Name="Normal">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_FocusVisual"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_Border"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlock"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlockUnderlined"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="HoverActionBorder">
                                    <Storyboard>                                        
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_FocusVisual"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_Border"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlock"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlockUnderlined"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="HoverActionUnderline">
                                    <Storyboard>                                        
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_FocusVisual"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_Border"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlock"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlockUnderlined"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="HoverActionBorderWithFocus">
                                    <Storyboard>                                        
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_Border"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_FocusVisual"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlock"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlockUnderlined"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>

                                <VisualState x:Name="HoverActionUnderlineWithFocus">
                                    <Storyboard>                                        
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_FocusVisual"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_Border"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlock"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_TextBlockUnderlined"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <TextBlock 
                            x:Name="ELEMENT_TextBlock"
                            Text="{TemplateBinding DisplayValue}" 
                            TextWrapping="{TemplateBinding TextWrapping}"
                            Width="{TemplateBinding Width}"                            
                            />
                        <TextBlock 
                            x:Name="ELEMENT_TextBlockUnderlined"
                            Text="{TemplateBinding DisplayValue}"
                            TextDecorations="Underline"
                            Visibility="Collapsed"
                            Foreground="Blue"  
                            TextWrapping="{TemplateBinding TextWrapping}"
                            Width="{TemplateBinding Width}"                            
                            />
                        <Rectangle 
                            x:Name="ELEMENT_FocusVisual"
                            Margin="-1"
                            StrokeDashArray="1 0.5 0.75"
                            Stroke="Black"
                            StrokeThickness="1"
                            Visibility="Collapsed"
                            />
                        <Rectangle 
                            x:Name="ELEMENT_Border"
                            Margin="-1"                            
                            Stroke="{TemplateBinding BorderBrush}"
                            StrokeThickness="1"
                            Visibility="Collapsed"
                            />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <!-- End Label Style -->
    
    <Style TargetType="Button" x:Key="CircularButton">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid>
                        <ContentPresenter HorizontalAlignment="Left"
                            VerticalAlignment="Center"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:AddressLabel">
        <Setter Property="AddressDisplayFormat" Value="InForm" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:AddressLabel">
                    <Grid x:Name="RootElement" Background="{TemplateBinding Background}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="ControlStates">
                                <VisualState x:Name="InForm">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_InLineAddress"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_InFormAddress"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="InLine">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_InLineAddress"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ELEMENT_InFormAddress"
                                            Storyboard.TargetProperty="Visibility"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        
                        <StackPanel x:Name="ELEMENT_InFormAddress" Width="{TemplateBinding Width}" Height="{TemplateBinding Height}" >
                            <TextBlock Text="{TemplateBinding Address1}"
                                       TextWrapping="Wrap" 
                                       TextAlignment="Left"
                                       Visibility="{TemplateBinding AddressLine1Visibility}"
                                       HorizontalAlignment="Left"
                                       />  
                            
                            <TextBlock Text="{TemplateBinding Address2}"
                                       TextWrapping="Wrap"     
                                       TextAlignment="Left"
                                       Visibility="{TemplateBinding AddressLine2Visibility}"
                                       />    
                            
                            <TextBlock Text="{TemplateBinding Address3}"
                                       TextWrapping="Wrap"     
                                       TextAlignment="Left"
                                       Visibility="{TemplateBinding AddressLine3Visibility}"
                                       />    
                            
                            <TextBlock Text="{TemplateBinding Town}"
                                       TextWrapping="Wrap"     
                                       TextAlignment="Left"
                                       Visibility="{TemplateBinding TownVisibility}"
                                       />    
                            
                            <TextBlock Text="{TemplateBinding County}"
                                       TextWrapping="Wrap"     
                                       TextAlignment="Left"
                                       Visibility="{TemplateBinding CountyVisibility}"
                                       />                                
                            
                            <TextBlock Text="{TemplateBinding PostcodeDisplayValue}"
                                       TextWrapping="Wrap"     
                                       TextAlignment="Left"
                                       Visibility="{TemplateBinding PostcodeVisibility}"
                                       />   
                            
                            <TextBlock Text="{TemplateBinding Country}"
                                       TextWrapping="Wrap"     
                                       TextAlignment="Left"
                                       Visibility="{TemplateBinding CountryVisibility}"
                                       />   
                        </StackPanel>

                        <TextBlock x:Name="ELEMENT_InLineAddress" Visibility="Collapsed"
                                   TextAlignment="Left" Text="{TemplateBinding InlineAddressDisplayText}" 
                                   TextWrapping="Wrap" Width="{TemplateBinding Width}" Height="{TemplateBinding Height}" />                                              
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:ContactLabel">
        <Setter Property="HomePhoneLabelText" Value="Home" />
        <Setter Property="WorkPhoneLabelText" Value="Work" />
        <Setter Property="MobilePhoneLabelText" Value="Mobile" />
        <Setter Property="EmailLabelText" Value="Email" />
        <Setter Property="LabelStyle">
            <Setter.Value>
                <Style TargetType="TextBlock">
                    <Setter Property="FontWeight" Value="Normal" />
                    <Setter Property="FontStyle" Value="Italic" />
                    <Setter Property="MaxWidth" Value="200" />
                    <Setter Property="TextWrapping" Value="Wrap" />
                    <Setter Property="HorizontalAlignment" Value="Right" />                    
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="DataStyle">
            <Setter.Value>
                <Style TargetType="TextBlock">
                    <Setter Property="FontWeight" Value="Bold" />
                    <Setter Property="FontStyle" Value="Normal" />
                    <Setter Property="TextWrapping" Value="Wrap" />
                    <Setter Property="Margin" Value="10,0" />                    
                </Style>
            </Setter.Value>
        </Setter>        
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:ContactLabel">
                    <Grid x:Name="RootElement" Width="{TemplateBinding Width}" Height="{TemplateBinding Height}" Background="{TemplateBinding Background}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"  />
                            <ColumnDefinition Width="*"  />
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Grid.Row="0" 
                                   Text="{TemplateBinding HomePhoneLabelText}" 
                                   Style="{TemplateBinding LabelStyle}"
                                   />
                        <TextBlock Grid.Column="1" Grid.Row="0" 
                                   Text="{TemplateBinding HomePhoneNumber}"
                                   Style="{TemplateBinding DataStyle}"
                                   />
                        
                        <TextBlock Grid.Column="0" Grid.Row="1"
                                   Text="{TemplateBinding WorkPhoneLabelText}"
                                   Style="{TemplateBinding LabelStyle}"
                                   />
                        <TextBlock Grid.Column="1" Grid.Row="1"
                                   Text="{TemplateBinding WorkPhoneNumber}" 
                                   Style="{TemplateBinding DataStyle}"
                                   />
                        
                        <TextBlock Grid.Column="0" Grid.Row="2"
                                   Text="{TemplateBinding MobilePhoneLabelText}" 
                                   Style="{TemplateBinding LabelStyle}"
                                   />
                        <TextBlock Grid.Column="1" Grid.Row="2" 
                                   Text="{TemplateBinding MobilePhoneNumber}" 
                                   Style="{TemplateBinding DataStyle}"
                                   />
                        
                        <TextBlock Grid.Column="0" Grid.Row="3"
                                   Text="{TemplateBinding EmailLabelText}" 
                                   Style="{TemplateBinding LabelStyle}"
                                   />
                        <TextBlock Grid.Column="1" Grid.Row="3"
                                   Text="{TemplateBinding EmailAddress}" 
                                   Style="{TemplateBinding DataStyle}"
                                   />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:PatientBanner">       
        <Setter Property="BorderBrush" Value="#8C8C8C" />               
        <Setter Property="BorderWidth" Value="5" />
        <Setter Property="ZoneOneMinHeight" Value="50" />
        <Setter Property="ZoneTwoExpanded" Value="False" />
        <Setter Property="AddressDisplayFormat" Value="InForm" />        
        <Setter Property="PatientImageVisible" Value="Collapsed" />        
        <Setter Property="PatientNameStyle">
            <Setter.Value>
                <Style TargetType="Control">
                    <Setter Property="FontSize" Value="18" />
                    <Setter Property="FontWeight" Value="Bold" />
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="ZoneOneLabelStyle">
            <Setter.Value>
                <Style TargetType="Control">
                    <Setter Property="FontSize" Value="13" />                    
                    <Setter Property="FontStyle" Value="Italic" /> 
                    <Setter Property="Margin" Value="4,1,2,0" />
                    <Setter Property="VerticalAlignment" Value="Bottom" />
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="ZoneOneDataStyle">
            <Setter.Value>
                <Style TargetType="Control">
                    <Setter Property="FontSize" Value="14" />
                    <Setter Property="FontWeight" Value="Bold" />                    
                    <Setter Property="VerticalAlignment" Value="Bottom" />
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="ZoneTwoTitleLabelStyle">
            <Setter.Value>
                <Style TargetType="Control">
                    <Setter Property="FontSize" Value="12" />
                    <Setter Property="FontStyle" Value="Italic" />
                    <Setter Property="IsTabStop" Value="False" />
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="ZoneTwoTitleDataStyle">
            <Setter.Value>
                <Style TargetType="Control">
                    <Setter Property="FontSize" Value="12" />
                    <Setter Property="FontWeight" Value="Bold" />
                    <Setter Property="IsTabStop" Value="False" />
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="ZoneTwoLabelStyle">
            <Setter.Value>
                <Style TargetType="Control">
                    <Setter Property="FontSize" Value="12" />
                    <Setter Property="FontStyle" Value="Italic" />
                    <Setter Property="IsTabStop" Value="False" />
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="ZoneTwoDataStyle">
            <Setter.Value>
                <Style TargetType="Control">
                    <Setter Property="FontSize" Value="12" />
                    <Setter Property="FontWeight" Value="Bold" />
                    <Setter Property="IsTabStop" Value="False" />
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="ZoneTwoLinksStyle">
            <Setter.Value>
                <Style TargetType="Control">
                    <Setter Property="FontSize" Value="12" />
                    <Setter Property="Foreground" Value="Blue" />
                    <Setter Property="Margin" Value="0,0,5,0" />
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:PatientBanner">
                    <Grid VerticalAlignment="Top" x:Name="RootElement">
                        <Grid.Resources>
                            <Color x:Key="StripeColour">#FFC0C0C0</Color>
                            <Color x:Key="StripeColour2">#FFCCCCCC</Color>
                            <SolidColorBrush x:Key="ZoneTwoTitleNormalForeground">Black</SolidColorBrush>
                            <SolidColorBrush x:Key="ZoneTwoTitleHoverForeground">White</SolidColorBrush>
                        </Grid.Resources>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="PatientStates">
                                <VisualState x:Name="Deceased">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="GridBorder"
                                            Storyboard.TargetProperty="StrokeDashArray"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <DoubleCollection>2</DoubleCollection>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ZoneOneContainer"
                                            Storyboard.TargetProperty="Background">
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <LinearGradientBrush EndPoint="0.05,0.01" StartPoint="0.001,0.999" SpreadMethod="Repeat">
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.01"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.02"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.08"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.09"/>
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0.1"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.11"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.12"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.18"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.19"/>
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0.2"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.21"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.22"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.28"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.29"/>
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0.3"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.31"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.32"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.38"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.39"/>
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0.4"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.41"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.42"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.48"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.49"/>
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0.5"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.51"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.52"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.58"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.59"/>
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0.6"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.61"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.62"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.68"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.69"/>
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0.7"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.71"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.72"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.78"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.79"/>
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0.8"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.81"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.82"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.88"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.89"/>
                                                        <GradientStop Color="{StaticResource StripeColour}" Offset="0.9"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="0.91"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.92"/>
                                                        <GradientStop Color="#FFFFFFFF" Offset="0.98"/>
                                                        <GradientStop Color="{StaticResource StripeColour2}" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="DeathDetailsPanel"
                                            Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Alive">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="GridBorder"
                                            Storyboard.TargetProperty="StrokeDashArray"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <DoubleCollection></DoubleCollection>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                                                                
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="ZoneOneContainer"
                                            Storyboard.TargetProperty="Background">
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000" Value="{TemplateBinding Background}">                                                
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="DeathDetailsPanel"
                                            Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.0010000">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="ZoneTwoStates">
                                <VisualState x:Name="ZoneTwoNormal">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ZoneTwoHeaderBorder"
                                                                       Storyboard.TargetProperty="Background"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{TemplateBinding Background}">                                                
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>

                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionOneTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleNormalForeground}" />                                                
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="AddressPreview"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleNormalForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionTwoTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleNormalForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContactPreview"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleNormalForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionThreeTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleNormalForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionFourTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleNormalForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionFiveTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleNormalForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>                                    
                                </VisualState>
                                <VisualState x:Name="ZoneTwoHover">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ZoneTwoHeaderBorder"
                                                                       Storyboard.TargetProperty="Background"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <SolidColorBrush>#C0C0C0</SolidColorBrush>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionOneTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleHoverForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="AddressPreview"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleHoverForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionTwoTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleHoverForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ContactPreview"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleHoverForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionThreeTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleHoverForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionFourTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleHoverForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="SubsectionFiveTitleLabel"
                                                                       Storyboard.TargetProperty="Foreground"
                                                                       >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.000100" Value="{StaticResource ZoneTwoTitleHoverForeground}" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="AllergyInformationStates">
                                <VisualState x:Name="AllergyDetailsKnown">
                                    <Storyboard>                                        
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="SubsectionFiveTitleLabel"
                                            Storyboard.TargetProperty="FontWeight"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.00100" Value="Bold" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="SubsectionFiveTitleLabel"
                                            Storyboard.TargetProperty="FontStyle"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.00100" Value="Normal" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="AllergyDetailsNotKnown">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="SubsectionFiveTitleLabel"
                                            Storyboard.TargetProperty="FontWeight"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.00100" Value="Normal" />
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames
                                            Storyboard.TargetName="SubsectionFiveTitleLabel"
                                            Storyboard.TargetProperty="FontStyle"
                                            >
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00.00100" Value="Italic" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="PatientImageVisibleStates">
                                <VisualState x:Name="PatientImageVisible">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PatientImage"
                                                                       Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Visible</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="PatientImageCollapsed">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PatientImage"
                                                                       Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="00:00:00">
                                                <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                                </DiscreteObjectKeyFrame.Value>
                                            </DiscreteObjectKeyFrame>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Rectangle x:Name="GridBorder" Stroke="{TemplateBinding BorderBrush}" 
                                   StrokeThickness="{TemplateBinding BorderWidth}"                                     
                                   >
                        </Rectangle>
                        
                        <Grid x:Name="PART_RootElement" Margin="{TemplateBinding BorderThickness}" ShowGridLines="False" Background="{TemplateBinding Background}">
                            <Grid.RowDefinitions>
                                <RowDefinition x:Name="ZoneOneRow" Height="Auto" MinHeight="{TemplateBinding ZoneOneMinHeight}" />
                                <RowDefinition  x:Name="ZoneTwoHeaderRow" Height="Auto" />
                                <RowDefinition  x:Name="ZoneTwoContentRow" Height="0" />
                                <RowDefinition x:Name="ZoneTwoLinksRow" Height="0" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width= "2*" />
                                <ColumnDefinition Width= "2*" />
                                <ColumnDefinition Width= "1*" />
                                <ColumnDefinition Width= "1*" />
                                <ColumnDefinition Width= "2*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions> 
                            
                            <!-- Zone one-->
                            <Grid x:Name="ZoneOneContainer" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6"
                                  MinHeight="{TemplateBinding ZoneOneMinHeight}"                                  
                                  >
                                <Grid x:Name="ZoneOne" Margin="5">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <Grid x:Name="PatientNamePanel" 
                                        VerticalAlignment="Center" HorizontalAlignment="Left"
                                        Grid.Column="0" 
                                        >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        
                                        <Image x:Name="PatientImage" Stretch="UniformToFill" 
                                               Height="48" Width="48" 
                                               Grid.Column="0" Grid.Row="0" Grid.RowSpan="2"                                       
                                               Source="{TemplateBinding PatientImage}" 
                                               Visibility="{TemplateBinding PatientImageVisible}"
                                               HorizontalAlignment="Left" />                                        

                                        <local:NameLabel x:Name="NameLabel" 
                                                         VerticalAlignment="Center" HorizontalAlignment="Left"
                                                         FamilyName="{TemplateBinding FamilyName}"
                                                         GivenName="{TemplateBinding GivenName}"
                                                         Title="{TemplateBinding Title}"
                                                         BorderBrush="{TemplateBinding BorderBrush}"
                                                         HoverAction="Underline"
                                                         ToolTip="{TemplateBinding PatientNameToolTip}"
                                                         Style="{TemplateBinding PatientNameStyle}"
                                                         Grid.Row="0" Grid.Column="1"
                                                         ShowHandOnHover="True"
                                                     />

                                        <StackPanel x:Name="PreferredNameDetails" 
                                                Orientation="Horizontal"                                                  
                                                Grid.Column="1" Grid.Row="1">
                                            <local:Label x:Name="PreferredNameLabelText" 
                                                     HorizontalAlignment="Left"
                                                     VerticalAlignment="Center"
                                                     Text="{TemplateBinding PreferredNameLabelText}" 
                                                     HoverAction="Border"
                                                     BorderBrush="{TemplateBinding BorderBrush}"
                                                     ToolTip="{TemplateBinding PreferredNameLabelToolTip}"
                                                     Style="{TemplateBinding ZoneOneLabelStyle}"
                                                     Margin="0,0,2,0"
                                                     />

                                            <local:Label x:Name="PreferredName" 
                                                     Text="{TemplateBinding PreferredName}" 
                                                     Margin="2,0,0,0"
                                                     HoverAction="Underline"                                                     
                                                     HorizontalAlignment="Left" VerticalAlignment="Center"
                                                     ToolTip="{TemplateBinding PreferredNameToolTip}"
                                                     Style="{TemplateBinding ZoneOneDataStyle}"
                                                   />


                                        </StackPanel>
                                    </Grid>

                                    <Grid x:Name="PatientDetailsPanel"
                                            HorizontalAlignment="Right" VerticalAlignment="Center"
                                            Grid.Column="1" Grid.Row="0"
                                            >
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="1"/>
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <local:WrapPanel Grid.Row="0" Grid.Column="1">
                                            <local:Label x:Name="DOBLabel" 
                                                         Text="{TemplateBinding DateOfBirthLabelText}" 
                                                         VerticalAlignment="Center"
                                                         HoverAction="Border" BorderBrush="{TemplateBinding BorderBrush}"
                                                         ToolTip="{TemplateBinding DateOfBirthLabelToolTip}"
                                                         Style="{TemplateBinding ZoneOneLabelStyle}"
                                                         TextWrapping="Wrap"
                                                     />

                                            <local:Label x:Name="DOBValue" 
                                                         Text="{TemplateBinding DateOfBirthText}" 
                                                         VerticalAlignment="Center"
                                                         HoverAction="Underline" 
                                                         BorderBrush="{TemplateBinding BorderBrush}"
                                                         ToolTip="{TemplateBinding DateOfBirthToolTip}"
                                                         Style="{TemplateBinding ZoneOneDataStyle}"
                                                         TextWrapping="Wrap"
                                                         />

                                            <local:Label x:Name="GenderLabel" 
                                                         Text="{TemplateBinding GenderLabelText}" 
                                                         VerticalAlignment="Center"
                                                         HoverAction="Border" 
                                                         BorderBrush="{TemplateBinding BorderBrush}"
                                                         ToolTip="{TemplateBinding GenderLabelTooltip}"
                                                         Style="{TemplateBinding ZoneOneLabelStyle}"
                                                         />

                                            <local:GenderLabel x:Name="GenderValue" 
                                                               VerticalAlignment="Center"
                                                               Value="{TemplateBinding Gender}"          
                                                               HoverAction="Underline" 
                                                               BorderBrush="{TemplateBinding BorderBrush}"
                                                               ToolTip="{TemplateBinding GenderValueTooltip}"
                                                               Style="{TemplateBinding ZoneOneDataStyle}"
                                                               ShowHandOnHover="True"
                                                           />

                                            <local:Label x:Name="IdentifierLabel"
                                                         Text="{TemplateBinding IdentifierLabelText}" 
                                                         VerticalAlignment="Center" 
                                                         HoverAction="Border" 
                                                         BorderBrush="{TemplateBinding BorderBrush}"
                                                         ToolTip="{TemplateBinding IdentifierLabelTooltip}"
                                                         Style="{TemplateBinding ZoneOneLabelStyle}"
                                                         />

                                            <local:IdentifierLabel x:Name="IdentifierValue" 
                                                                   VerticalAlignment="Center"                         
                                                                   IdentifierType="{TemplateBinding IdentifierType}" 
                                                                   Text="{TemplateBinding Identifier}"
                                                                   HoverAction="Underline" 
                                                                   BorderBrush="{TemplateBinding BorderBrush}"
                                                                   ToolTip="{TemplateBinding IdentifierTooltip}"
                                                                   Style="{TemplateBinding ZoneOneDataStyle}"
                                                                   ShowHandOnHover="True"
                                                                   />
                                        </local:WrapPanel>

                                        <local:WrapPanel x:Name="DeathDetailsPanel" Grid.Row="1" Grid.Column="1">
                                            <local:Label x:Name="DODLabel" 
                                                     Text="{TemplateBinding DateOfDeathLabelText}" 
                                                     VerticalAlignment="Center"
                                                     HoverAction="Border" 
                                                     BorderBrush="{TemplateBinding BorderBrush}"
                                                     ToolTip="{TemplateBinding DateOfDeathLabelToolTip}"
                                                     Style="{TemplateBinding ZoneOneLabelStyle}"
                                                     />

                                            <local:Label x:Name="DODValue" 
                                                     Text="{TemplateBinding DateOfDeathText}" 
                                                     VerticalAlignment="Center"                           
                                                     HoverAction="Underline" 
                                                     BorderBrush="{TemplateBinding BorderBrush}"
                                                     ToolTip="{TemplateBinding DateOfDeathToolTip}"
                                                     Style="{TemplateBinding ZoneOneDataStyle}"
                                                     />

                                            <local:Label x:Name="AgeAtDeathLabel" 
                                                     Text="{TemplateBinding AgeAtDeathLabelText}" 
                                                     VerticalAlignment="Center"
                                                     HoverAction="Border" 
                                                     BorderBrush="{TemplateBinding BorderBrush}"
                                                     ToolTip="{TemplateBinding AgeAtDeathLabelTooltip}"
                                                     Style="{TemplateBinding ZoneOneLabelStyle}"
                                                     />

                                            <local:Label x:Name="AgeAtDeathValue" 
                                                     Text="{TemplateBinding AgeAtDeath}" 
                                                     VerticalAlignment="Center"                      
                                                     HoverAction="Underline" 
                                                     BorderBrush="{TemplateBinding BorderBrush}"
                                                     ToolTip="{TemplateBinding AgeAtDeathTooltip}"
                                                     Style="{TemplateBinding ZoneOneDataStyle}"
                                                     />
                                        </local:WrapPanel>
                                    </Grid>

                                </Grid>
                            </Grid>

                            <!-- Zone two headers-->
                            <Border x:Name="ZoneTwoHeaderBorder" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    Background="{TemplateBinding Background}" 
                                    BorderThickness="0" 
                                    Grid.Column="0" Grid.ColumnSpan="6" Grid.Row="1"
                                    />

                            <Border x:Name="SubsectionOne" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="0,1,1,0" 
                                    Grid.Column="0" Grid.Row="1"
                                    ToolTipService.ToolTip="{TemplateBinding ZoneTwoTooltip}"
                                    >
                                <StackPanel Orientation="Horizontal" x:Name="SubSectionOneHeader" Background="Transparent">
                                    <local:Label HoverAction="None" TextWrapping="NoWrap" x:Name="SubsectionOneTitleLabel" Margin="5,0,0,0"  Text="{TemplateBinding SubSectionOneTitle}" VerticalAlignment="Center" 
                                                 Style="{TemplateBinding ZoneTwoTitleLabelStyle}"
                                           />
                                    <local:Label HoverAction="None" TextWrapping="NoWrap" x:Name="AddressPreview" Margin="5,0,0,0" VerticalAlignment="Center"
                                                   Style="{TemplateBinding ZoneTwoTitleDataStyle}" Text="{TemplateBinding AddressPreview}"
                                                    />
                                </StackPanel>
                            </Border>

                            <Border x:Name="SubsectionTwo" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="0,1,1,0" 
                                    Grid.Column="1" Grid.Row="1"
                                    ToolTipService.ToolTip="{TemplateBinding ZoneTwoTooltip}"
                                    >
                                <StackPanel Orientation="Horizontal" Background="Transparent" Width="Auto" x:Name="SubSectionTwoHeader">

                                    <local:Label HoverAction="None" TextWrapping="NoWrap" Margin="5,0,0,0" x:Name="SubsectionTwoTitleLabel" Text="{TemplateBinding SubSectionTwoTitle}"  VerticalAlignment="Center"
                                                                               Style="{TemplateBinding ZoneTwoTitleLabelStyle}"/>
                                    <local:Label HoverAction="None" TextWrapping="NoWrap" x:Name="ContactPreview"  Margin="5,0,0,0" Text="{TemplateBinding ContactPreview}"  VerticalAlignment="Center"
                                                                                             Style="{TemplateBinding ZoneTwoTitleDataStyle}"            />
                                </StackPanel>
                            </Border>

                            <Border x:Name="SubsectionThree" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="0,1,1,0" 
                                    Grid.Column="2" Grid.Row="1"
                                    ToolTipService.ToolTip="{TemplateBinding ZoneTwoTooltip}"                                    
                                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                    Background="Transparent"
                                    >                                
                                    <local:Label x:Name="SubsectionThreeTitleLabel"
                                                 HoverAction="None" TextWrapping="NoWrap" 
                                                 Margin="5,0,0,0" 
                                                 Text="{TemplateBinding SubSectionThreeTitle}"  
                                                 VerticalAlignment="Center"
                                                 Style="{TemplateBinding ZoneTwoTitleLabelStyle}"                                                                                                  
                                                 />
                                
                            </Border>

                            <Border x:Name="SubsectionFour" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="0,1,1,0" 
                                    Grid.Column="3" Grid.Row="1"
                                    ToolTipService.ToolTip="{TemplateBinding ZoneTwoTooltip}"  
                                    HorizontalAlignment="Stretch" Background="Transparent" VerticalAlignment="Stretch"
                                    >
                                <local:Label x:Name="SubsectionFourTitleLabel"
                                             HoverAction="None" 
                                             TextWrapping="NoWrap" 
                                             Margin="5,0,0,0" 
                                             Text="{TemplateBinding SubSectionFourTitle}"  
                                             VerticalAlignment="Center" 
                                             Style="{TemplateBinding ZoneTwoTitleLabelStyle}"
                                             />
                            </Border>

                            <Border x:Name="SubsectionFive" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="0,1,1,0" 
                                    Grid.Column="4" Grid.Row="1"
                                    ToolTipService.ToolTip="{TemplateBinding ZoneTwoTooltip}"                                    
                                    >
                                <StackPanel Background="Transparent"  Orientation="Horizontal" x:Name="SubSectionFiveHeader">
                                    <Image x:Name="AllergiesImage" Stretch="UniformToFill" Margin="5,0,0,0"  Height="16" Width="16" VerticalAlignment="Center"></Image>
                                    <local:Label x:Name="SubsectionFiveTitleLabel" 
                                                 HoverAction="None" 
                                                 TextWrapping="NoWrap" 
                                                 Margin="5,0,0,0" 
                                                 Text="{TemplateBinding AllergyStatus}" 
                                                 VerticalAlignment="Center" 
                                                 Style="{TemplateBinding ZoneTwoTitleLabelStyle}"
                                                 />
                                </StackPanel>
                            </Border>

                            <Border x:Name="ExpandCollapseImagePanel" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="0,1,0,0" 
                                Grid.Column="5" Grid.Row="1"
                                ToolTipService.ToolTip="{TemplateBinding ZoneTwoTooltip}"
                                >
                                <StackPanel Background="Transparent"  x:Name="SubSectionSixHeader" Height="Auto" VerticalAlignment="Center">
                                    <Button x:Name="ButtonExpand" Background="{TemplateBinding Background}" Style="{StaticResource CircularButton}" MaxWidth="20" MaxHeight="20">
                                    </Button>
                                </StackPanel>
                            </Border>


                            <!-- Zone two content-->

                            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="0,1,1,0" Grid.Column="0" Grid.Row="2" >
                                <Grid Margin="5,0,0,0" x:Name="SubsectionOneContent">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"></RowDefinition>
                                        <RowDefinition Height="Auto"></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <local:Label 
                                        x:Name="AddressTypeLabel"
                                        IsTabStop="False"
                                        HoverAction="None" 
                                        Text="{TemplateBinding AddressTypeLabelText}" 
                                        Grid.Row="0"                                          
                                        Style="{TemplateBinding ZoneTwoLabelStyle}"
                                        ShowHandOnHover="False"
                                        />
                                    <local:AddressLabel x:Name="AddressLabel" 
                                                        IsTabStop="False"                                                          
                                                        Grid.Row="1" 
                                                        AddressDisplayFormat="{TemplateBinding AddressDisplayFormat}" 
                                                        Address1="{TemplateBinding Address1}"
                                                        Address2="{TemplateBinding Address2}"
                                                        Address3="{TemplateBinding Address3}"
                                                        Town="{TemplateBinding Town}"
                                                        County="{TemplateBinding County}"
                                                        Country="{TemplateBinding Country}"
                                                        Postcode="{TemplateBinding Postcode}"
                                                        Style="{TemplateBinding ZoneTwoDataStyle}"
                                                        />
                                </Grid>
                            </Border>

                            <Border BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}" BorderThickness="0,1,1,0" Grid.Column="1" Grid.Row="2">
                                <StackPanel Orientation="Vertical" x:Name="SubsectionTwoContent">
                                    <local:ContactLabel x:Name="ContactLabel" 
                                                        Margin="5,0,0,0" 
                                                        HomePhoneNumber="{TemplateBinding HomePhoneNumber}" 
                                                        WorkPhoneNumber="{TemplateBinding WorkPhoneNumber}" 
                                                        MobilePhoneNumber="{TemplateBinding MobilePhoneNumber}" 
                                                        EmailAddress="{TemplateBinding EmailAddress}" 
                                                        HomePhoneLabelText="{TemplateBinding HomePhoneLabelText}"
                                                        MobilePhoneLabelText="{TemplateBinding MobilePhoneLabelText}"
                                                        WorkPhoneLabelText="{TemplateBinding WorkPhoneLabelText}"
                                                        EmailLabelText="{TemplateBinding EmailLabelText}"  
                                                        IsTabStop="False"                                                
                                                        Style="{TemplateBinding ZoneTwoDataStyle}"
                                                        />
                                </StackPanel>
                            </Border>

                            <Border BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}" BorderThickness="0,1,1,0" Grid.Column="2" Grid.Row="2" x:Name="SubsectionThreeContentPanel">
                                <ContentControl IsTabStop="False" Content="{TemplateBinding SubSectionThreeContent}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" /> 
                            </Border>

                            <Border BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}" BorderThickness="0,1,1,0" Grid.Column="3" Grid.Row="2" x:Name="SubsectionFourContentPanel">
                                <ContentControl IsTabStop="False" Content="{TemplateBinding SubSectionFourContent}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" />
                            </Border>

                            <Border Background="{TemplateBinding Background}"  BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="0,1,0,0" Grid.Column="4" Grid.Row="2" Grid.ColumnSpan="2">
                                <local:AllergiesLabel x:Name="AllergiesLabel" Margin="5,0,0,0"
                                                      Allergies="{TemplateBinding Allergies}" 
                                                      Style="{TemplateBinding ZoneTwoDataStyle}"
                                                      MaxAllergiesToShow="5"
                                                      />
                            </Border>

                            <!-- Zone two links-->

                            <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="0,0,1,0" Grid.Column="0" Grid.Row="3" Background="{TemplateBinding Background}">
                                <StackPanel x:Name="ViewAllAddressLinkPanel" Orientation="Horizontal" HorizontalAlignment="Right">
                                    <local:Label x:Name="ViewAllAddressLink" 
                                             Text="{TemplateBinding ViewAllAddressLinkText}" 
                                             HoverAction="Underline"
                                             Style="{TemplateBinding ZoneTwoLinksStyle}"
                                             />
                                </StackPanel>

                            </Border>

                            <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="0,0,1,0" Background="{TemplateBinding Background}" Grid.Column="1" Grid.Row="3">
                                <StackPanel x:Name="ViewContactDetailsLinkPanel" Orientation="Horizontal" HorizontalAlignment="Right">
                                    <local:Label x:Name="ViewContactDetailsLink" 
                                             Text="{TemplateBinding ViewAllContactDetailsLinkText}" 
                                             HoverAction="Underline"
                                             Style="{TemplateBinding ZoneTwoLinksStyle}"
                                             />
                                </StackPanel>
                            </Border>

                            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="0,0,1,0" Grid.Column="2" Grid.Row="3" />
                            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="0,0,1,0" Grid.Column="3" Grid.Row="3" />

                            <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="0" Background="{TemplateBinding Background}" Grid.Column="4" Grid.Row="3" Grid.ColumnSpan="2">
                                <StackPanel x:Name="ViewAllergyRecordLinkPanel"  Orientation="Horizontal" HorizontalAlignment="Right">
                                    <local:Label x:Name="ViewAllergyRecordLink" 
                                             Text="{TemplateBinding ViewAllergyRecordLinkText}" 
                                             HoverAction="Underline"
                                             Style="{TemplateBinding ZoneTwoLinksStyle}"
                                             />
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>  
    
    <!--Level Of Detail Control-->
    <Style TargetType="local:LevelOfDetailTick">
        <Setter Property="MinWidth" Value="10" />
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Grid>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Selected">
                                    <Storyboard>
                                        <ColorAnimation 
                                            Duration="00:00:00"
                                            To="#E8C77A"
                                            Storyboard.TargetName="ELEMENT_Tick"
                                            Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)"
                                            />                                         
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="UnSelected">
                                    <Storyboard>
                                        <ColorAnimation 
                                            Duration="00:00:00"
                                            To="#ADD8E6"
                                            Storyboard.TargetName="ELEMENT_Tick"
                                            Storyboard.TargetProperty="(Shape.Fill).(SolidColorBrush.Color)"
                                            />
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <Rectangle x:Name="ELEMENT_Tick" Height="20" Fill="LightBlue" Stroke="DarkBlue" StrokeThickness="1" Margin="2" RadiusX="4" RadiusY="4" />
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <Style TargetType="local:LevelOfDetail">
        <Setter Property="Background">
            <Setter.Value>
                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                    <GradientStop Color="AliceBlue" Offset="0"/>
                    <GradientStop Color="LightBlue" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:LevelOfDetail">
                    <Grid x:Name="ELEMENT_LayoutRoot" Margin="0.5" Background="{TemplateBinding Background}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="30" />
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="30" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="{TemplateBinding Label}"                                   
                                   VerticalAlignment="Center" 
                                   Margin="4" 
                                   Grid.Column="0" Grid.Row="1"
                                   />

                        <Button x:Name="ELEMENT_DecrementButton" 
                                Height="22" 
                                Width="22" 
                                Margin="4,4,0,4" 
                                Grid.Column="1" Grid.Row="1"
                                >
                            <Button.Content>
                                <Grid>
                                    <Ellipse Width="14" Height="14" Margin="0,-2" Stroke="DarkBlue" Fill="LightBlue" StrokeThickness="1" />
                                    <Path Margin="0,-1.4" Stroke="DarkBlue" Data="M 3,6.5 L 11,6.5" StrokeThickness="1.5"/>
                                </Grid>
                            </Button.Content>
                        </Button>

                        <StackPanel x:Name="ELEMENT_TickContainer"                                    
                                    Grid.Column="2" Grid.Row="1"
                                    Orientation="Horizontal"
                                    >
                            <StackPanel.Resources>
                                <DataTemplate x:Key="TickTemplate">
                                    <local:LevelOfDetailTick />
                                </DataTemplate>
                            </StackPanel.Resources>
                        </StackPanel>
                        
                        <Button x:Name="ELEMENT_IncrementButton" 
                                Height="22" 
                                Width="22" 
                                Margin="0,4,4,4"
                                Grid.Column="3" Grid.Row="1"
                                >
                            <Button.Content>
                                <Grid>
                                    <Ellipse Width="14" Height="14" Margin="0,-2" Stroke="DarkBlue" Fill="LightBlue" StrokeThickness="1" />
                                    <Path Margin="0,-1.45" Stroke="DarkBlue" Data="M 3,6.5 L 11,6.5" StrokeThickness="1.5"/>
                                    <Path Margin="0,-2" Stroke="DarkBlue" Data="M 7,3 L 7,11" StrokeThickness="1.5"/>
                                </Grid>
                            </Button.Content>
                        </Button>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
